/*
 * impexjs is a powerful web application engine to build 
 * reactive webUI system
 *
 *
 * Copyright 2015-2018 MrSoya and other contributors
 * Released under the MIT license
 *
 * website: http://impexjs.org
 * last build: 2018-1-8
 */
!function(e){"use strict";function t(e,t){for(var n=Object.keys(e),r=n.length;r--;){var i=n[r];t[i]=e[i]}}function n(e){return"object"==typeof e&&null!==e}function r(e){return e instanceof Array}function i(e){return"string"==typeof e}function a(e){return void 0===e}function o(e){return e instanceof Function}function s(){ye("can not fetch remote data of : "+this.url)}function c(){ye("load timeout : "+this.url)}function l(){if(0===this.status||this.status>=200&&this.status<300||304===this.status){{var e=this.responseText,t=Oe[this.url],n=t.cbks;t.name}e=e.replace(/<!--[\s\S]*?-->/gm,"").trim(),e.match(/<\s*template[^<>]*>([\s\S]*)<\s*\/\s*template\s*>/gim)[0];var r=RegExp.$1;if(!r)return void ye("can not find tag <template> in component file");var i="";r=r.replace(/<\s*style[^<>]*>([\s\S]*?)<\s*\/\s*style\s*>/gim,function(e,t){return i+=t,""}),e.match(/<\s*script[^<>]*>([\s\S]*?)<\s*\/\s*script\s*>/gim)[0];var a=RegExp.$1,o=new Function("return ("+a+")")();o.template=r.trim();{this.url}n.forEach(function(e){e(o,i.trim())}),Oe[this.url]=null}}function u(e,t,n,r){if(Oe[t])return void Oe[t].cbks.push(n);Oe[t]={name:e,cbks:[]},Oe[t].cbks.push(n);var i=new XMLHttpRequest;i.open("get",t,!0),i.timeout=r||5e3,i.ontimeout=c,i.onerror=s,null===i.onload?i.onload=l:i.onreadystatechange=l,i.url=t,i.send(null)}function f(e,t,n){this.type=e,this.tag=t,this.txtQ=n,this.children=[],this.attrNodes={},this.slotMap={}}function p(e,t){this.value,this.name=e,this.directive=t}function h(e,t,n){this.tag=e,this.txt,this.children,this.vid=Ne++,this.attrNodes=t,this._directives=n,this._comp,this.dom,this._forScopeQ,this._slotMap}function d(e,t,n,r,i,a,o,s){if(t){var c=new h(n,r,i),l=null;if(s&&(l=c._forScopeQ=[s]),ft[n]||"component"==n){c._comp=!0;var u=a[0];return u&&(c._slots=u[0],c._slotMap=u[1]),c}if(null!=o){var f,p=(S(o),F("<"+n+">"+o+"</"+n+">",e));try{f=p.call(e,e.state,d,v,m,_,g)}catch(b){return void ye("[x-html] compile error on "+b.message)}a=f.children||[]}return a.length>0&&(c.children=[],a.forEach(function(e){if(e)if(e instanceof Array)e.forEach(function(e){if(e.parent=c,c.children.push(e),l){var t=e._forScopeQ;e._forScopeQ=t?l.concat(t):l}});else if(e.parent=c,c.children.push(e),l){var t=e._forScopeQ;e._forScopeQ=t?l.concat(t):l}})),c}}function v(e,t,n){if(e){var r=null;n&&(r=[n]);var i=[];return t.length>0&&t.forEach(function(e){if(e)if(e instanceof Array)e.forEach(function(e){if(i.push(e),r){var t=e._forScopeQ;e._forScopeQ=t?r.concat(t):r}});else if(i.push(e),r){var t=e._forScopeQ;e._forScopeQ=t?r.concat(t):r}}),i}}function m(e){var t=new h;return t.txt=e&&e.toString?e.toString():e,t}function _(e,t,n,i,a){var o=[];return e.forEach(function(e,s){var c={$index:s};i&&(c[i]=s),c[a]=e;var l=t.call(n,c);l&&(r(l)?o=o.concat(l):o.push(l))}),o}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=lt[r[0]],a=r[1];a.unshift(e),e=i.apply(i,a)}return e}function b(e,t){var n=null,r=null,i=null;if(We.test(e)){var a=e.replace(Ue,""),o=a.indexOf(He);o>-1&&(a=a.substring(0,o)),n=a;var s=e.indexOf(He);switch(s>-1&&(r=e.substr(s+1)),a){case"if":case"for":case"html":return a}if(!ut[a])return void be("指令 '"+a+"' 没有对应的处理器")}else e[0]===et?(n="on",r=e.substr(1)):e[0]!==tt||t||(n="bind",r=e.substr(1));if(r){var c=r.indexOf(Ye);c>-1&&(i=r.substr(c+1),r=r.substring(0,c)),r=r.split(He)}return n?[n,r,i]:n}function y(e,t){if("for"!==e)return!1;var n=null,r=t.exp[0],i=t.exp[1];if(!r.match(/^([\s\S]*?)\s+as\s+([\s\S]*?)$/))return void ye("invalid each expression : "+r);var a=RegExp.$2,o=a.split(","),s=o.length>1?o[0]:null,c=o.length>1?o[1]:o[0],l=RegExp.$1;return n=l.match(/^([\s\S]*?)\s+to\s+([\s\S]*?)$/)?[s,c,i,RegExp.$1,RegExp.$2]:[s,c,i,l]}function w(e,t){return"if"!==e?!1:t.exp[0]}function x(e,t){return"html"!==e?!1:t.exp[0]}function O(e){return e.replace(/&gt;/gim,">").replace(/&lt;/gim,"<")}function S(e){for(var t,n,r=null,i="",a=null,o=null,s=null,c=!1,l=[],u=[],h=Xe.length,d=Ze.length,v=!1,m=null,_=0,g=0,S=nt.length,N=rt.length,k=0,E="",C=null,A=[],F="",j=[],T=[],P=0;P<=e.length;P++){var M=e[P];if(r||"<"!==M){if(r||(r="t"),"a"===r||"t"===r||"efp"===r){if(i.length>=h&&!v){var V=i.substr(i.length-h);if(V==Xe){var $=0===g?g:g+d;if(j.push(i.substr($).replace(Xe,"")),v=!0,_=i.length,"a"===r){var B=o.name;return void ye("属性'"+B+"'不能包含表达式，动态内容请使用 'x-bind:"+B+" / ."+B+"'替代")}}}c=!1,"\\"===M&&(c=!0),!v||"'"!==M&&'"'!==M||(m?M!==m||c||(m=null):m=M)}switch(r){case"n":if(" "===M||"\n"===M||"	"===M||">"===M){if(!i)break;if(i.indexOf("<")>-1)return void ye("unexpected identifier '<' in tagName '"+i+"'");var L=new f(1,i);a=u[u.length-1],ft[i]&&(t=L),i===st&&(n=[a,L],T.push(n)),a&&a.children.push(L),Ee.indexOf(i)>-1&&(L.isVoid=!0),u.length<1&&l.push(L),a=L,L.isVoid||u.push(a),">"===M?(L.isVoid&&(a=u[u.length-1]),r="t"):r="a",i="";break}if("/"===M){r="e";break}i+=M;break;case"e":if(" "===M||"	"===M)break;if(">"===M){u.pop(),a=u[u.length-1],t&&t.tag===i&&(t=null),i===st&&(n=null),r="t",i="";break}i+=M;break;case"a":if(!s&&i.length<1&&(" "===M||"	"===M))break;if(!s&&">"===M){a.isVoid&&(a=u[u.length-1]),r="t";break}if(o){if("'"===M||'"'===M){if(!s){s=M,o.directive&&(v=!0,_=0);break}if(M===s&&!c){if(o.value=i,o.name===st&&(t.slotMap[i]=a),n&&"name"===o.name&&n.push(i),o.directive){var Q=null,D=o.directive;("for"===D||"if"===D||"html"===D)&&((Q=y(D,o))&&(a["for"]=Q),(Q=w(D,o))&&(a["if"]=Q),(Q=x(D,o))&&(a.html=Q),a.attrNodes[o.name]=null,delete a.attrNodes[o.name])}o=null,s=null,i="";break}}i+=M;break}var z=i.length>0&&(" "===M||"	"===M);if("="===M||z){var R=i.trim();o=new p(R,b(R,t)),a.attrNodes[R]=o,i="",z&&(o=null);break}i+=M;break;case"t":if(!(v||"<"!==M&&M)){var Q=i.replace(/^\s*|\s*$/,"");if(Q){var q=i;j.length>0&&(q=q.substr(g+d,i.length-h)),q&&j.push(q);var J=new f(3,null,j);j=[],a&&a.children.push(J),g=0}r="n",i="";break}i+=M;break;case"ef":if(" "===M||"	"===M)break;var U=!0;M===at?(E={name:E,param:[]},A.push(E),r="efp",U=!1):M===it&&(E={name:E,param:[]},A.push(E),E="",U=!1),i+=M,U&&(E+=M);break;case"efp":var U=!0;if(!m){if(" "===M||"	"===M)break;!E||M!==at&&M!==it||(E.param.push(F),F="",U=!1,M===it&&(r="ef",E=""))}U&&(F+=M),i+=M}if(("a"===r||"t"===r||"ef"===r||"efp"===r)&&v){var H=i.substr(i.length-S),Y=i.substr(i.length-N);if(H!==nt&&Y!==rt||"ef"===r||m){if(v){var X=i.substr(i.length-d),Z=X===Ze,W=!1;if(o&&o.directive&&s&&!m&&!c&&e[P+1]==s&&(W=Z=!0),Z){switch(r){case"t":if(m)continue;break;case"ef":if(E){var Q=new RegExp(Ze+"$");E=E.replace(Q,""),E={name:E,param:[]},A.push(E)}break;case"efp":if(F){var Q=new RegExp(Ze+"$");F=F.replace(Q,""),E.param.push(F)}}v=!1;var G=i.substring(_,k||i.length-d);g=i.length-d,W&&(G=i.substring(0,k||i.length)),k=0,"t"===C||"t"===r?j.push(["("+O(G)+")",A]):("a"===C||"a"===r)&&(o.exp=[G,A],g=0),E="",A=[],C&&(E="",F="",r=C,C=null)}}}else C=r,r="ef",k=H===nt?i.length-S:i.length-N}}else r="n"}return[l,T]}function N(e){var t=k(e);return"with(scope){return "+t+"}"}function k(e){var t="";if(1===e.type){var n="";if(ft[e.tag])n=JSON.stringify([e.children,e.slotMap]);else{for(var r=0;r<e.children.length;r++)n+=","+k(e.children[r]);n.length>0&&(n=n.substr(1))}var i=E(e.attrNodes),a=i[0],o=i[1],s=e["if"]||"true",c=e.html||"null",l="_ce(this,"+s+',"'+e.tag+'",'+a+","+o+",["+n+"],"+c;if("template"==e.tag&&(l="_tmp("+s+",["+n+"]"),e["for"]){var u=(e["for"][0]||"").trim(),f=e["for"][1].trim(),p=e["for"][2],h=e["for"][3],d=e["for"][4],v=h;d&&(h=h.replace(/(this[.a-z_$0-9]+)?[_$a-z][_$a-z0-9]*\(/gim,function(e){return 0===e.indexOf("this")?e:"this."+e}),d=d.replace(/(this[.a-z_$0-9]+)?[_$a-z][_$a-z0-9]*\(/gim,function(e){return 0===e.indexOf("this")?e:"this."+e}),v="(function(){var rs=[];for(var i="+h+";i<="+d+";i++)rs.push(i);return rs;}).call(this)"),p&&(v="_fi("+v+","+A(p)+")"),t+="_li("+v+",function(forScope){ with(forScope){return "+l+',forScope)}},this,"'+u+'","'+f+'")'}else t+=l+")"}else{var m=C(e.txtQ);t+="_ct("+m+")"}return t}function E(e){var t={},n="";for(var r in e){var i=e[r];if(i.directive){var a=i.value.replace(/(this[.a-z_$0-9]+)?[_$a-z][_$a-z0-9]*\(/gim,function(e){return 0===e.indexOf("this")?e:"this."+e});n+=",['"+r+"',"+JSON.stringify(i.directive)+","+("on"===i.directive[0]?JSON.stringify(a):a)+","+JSON.stringify(a)+"]"}else t[r]=i.value}return[JSON.stringify(t),"["+n.substr(1)+"]"]}function C(e){var t="";return e.forEach(function(e){if(e instanceof Array){var n=e[0],r=e[1];t+=r.length>0?"+_fi("+n+","+A(r)+")":"+"+n}else e&&(t+="+"+JSON.stringify(e))}),t=t.replace(/\n/gm,""),t.length>0&&(t=t.substr(1)),t}function A(e){var t="";return e.forEach(function(e){var n='["'+e.name+'",['+e.param.toString()+"]]";t+=","+n}),"["+t.substr(1)+"]"}function F(e,t){if(ke[e]&&!t.__slots&&!t.__slotMap)return ke[e];var n=S(e),r=n[0];r.length>1&&be("组件只能有唯一的顶级节点");var i=r[0];return 1!=i.type||"template"==i.tag||"slot"==i.tag||i["for"]?void ye("组件顶级标签不能是template / slot"):(le(n[1],t.__slots,t.__slotMap),i=N(i),i=new Function("scope,_ce,_tmp,_ct,_li,_fi",i),ke[e]=i,i)}function j(e){var t=F(e.compiledTmp,e),n=null;try{n=t.call(e,e.state,d,v,m,_,g)}catch(r){ye("compile error : "+r.message)}return n}function T(e,t,n){return Ce={},Q(e,t)?P(e,t,n):(V(e,t,t.parent?t.parent.children:null,t.parent,n),B(t)),Ce}function P(e,t,n){if(e._comp)return void(Ce[t._cid]=e._forScopeQ);if(e.tag){for(var r=!1,i=e._directives.length;i--;){var a=e._directives[i],o=t._directives[i];if(a[2]!==o[2]){r=!0;break}}Object.keys(e.attrNodes).length!=Object.keys(t.attrNodes).length&&(r=!0),r&&e._directives.forEach(function(t){var n=t[1][0];if("on"!==n){var r=ut[n];if(r){var i=t[1][1],a=t[2],o=t[3];r.onBind&&r.onBind(e,{value:a,args:i,exp:o})}}}),z(e,t),t._forScopeQ&&(t._forScopeQ=e._forScopeQ)}else e.txt!==t.txt&&D(e,t);e.children&&t.children?M(e.children,t.children,t,n):e.children?L(t,e.children,n):t.children&&t.children.length>0&&B(t.children)}function M(e,t,n,r){for(var i=0,a=t.length-1,o=0,s=e.length-1,c=t[0],l=t[a],u=e[0],f=e[s];a>=i&&s>=o;)Q(u,c)?(P(u,c,r),c=t[++i],u=e[++o]):Q(f,l)?(P(f,l,r),l=t[--a],f=e[--s]):Q(f,c)?(V(c,$(l),t,n,r),c=t[i],a--,f=e[--s]):Q(u,l)?(V(l,c,t,n,r),l=t[a],i++,u=e[++o]):u.getAttribute("xid")||(V(u,c,t,n,r),B(c),c=t[++i],u=e[++o]);if(a>=i&&a>0){var p=t.splice(i,a-i+1);p.length>0&&B(p)}if(s>=o){var h=o==s?[e[o]]:e.splice(o,s-o+1);h.length>0&&V(h,t[i],t,n,r)}}function V(e,t,n,i,a){if(n){if(e.dom){var o=n.indexOf(e);o>-1&&n.splice(o,1)}var s=i;if(t)if(o=n.indexOf(t),s=s||t.parent,r(e)){for(var c=e.length;c--;)e[c].parent=s;var l=[o,0].concat(e);n.splice.apply(n,l)}else e.parent=s,n.splice(o,0,e);else r(e)?e.forEach(function(e){n.push(e),e.parent=s}):(e.parent=s,n.push(e))}var u=e.dom,f=[];if(u)u.parentNode.removeChild(u);else if(r(e)){for(var p=document.createDocumentFragment(),o=0;o<e.length;o++){var h=e[o],d=re(h,a);h._comp&&(se(h._comp),f.push(h._comp)),p.appendChild(d)}u=p}else u=re(e,a),e._comp&&(se(e._comp),f.push(e._comp));if(t){var v=t.dom;v.parentNode.insertBefore(u,v)}else i.dom.appendChild(u);for(var o=0;o<f.length;o++){var d=f[o];pe(d,i)}}function $(e){var t=e.parent,n=t.children.indexOf(e);return t.children[n+1]}function B(e){r(e)||(e=[e]);for(var t=e[0].parent,n=e.length;n--;){var i=e[n],a=t.children.indexOf(i);a>-1&&t.children.splice(a,1);var o=i.dom.parentNode;o&&o.removeChild(i.dom),vt._cs[i._cid]&&i.getAttribute(ot)&&vt._cs[i._cid].destroy()}}function L(e,t,n){e.children=t;for(var r=document.createDocumentFragment(),i=[],a=0;a<t.length;a++){var o=t[a],s=re(o,n);o._comp&&(se(o._comp),i.push(o._comp)),r.appendChild(s)}e.dom.appendChild(r);for(var a=0;a<i.length;a++){var c=i[a];pe(c,e)}}function Q(e,t){return e._comp?t.getAttribute(ot)==e.tag?!0:!1:t.tag===e.tag}function D(e,t){t.txt=e.txt;var n=t.dom;n.textContent=e.txt}function z(e,t){for(var i=e.attrNodes,a=t.attrNodes,o=Object.keys(i),s=Object.keys(a),c=t.dom,l=o.length;l--;){var u=o[l],f=s.indexOf(u);0>f?c.setAttribute(u,i[u]):(i[u]!=a[u]&&c.setAttribute(u,i[u]),s.splice(f,1))}for(var l=s.length;l--;)s[l]!==ot&&c.removeAttribute(s[l]);var p=t.attrNodes[ot];t.attrNodes=e.attrNodes,p&&(t.attrNodes[ot]=p),t._directives=e._directives,t._directives.forEach(function(e){(r(e[2])||n(e[2]))&&(e[2]=JSON.parse(JSON.stringify(e[2])))})}function R(e,t){var n=t.target;do{var r=n._vid;if(void 0!==r){var i=pt[e];if(i){var a=i[r];if(a){var o=a[0],s=a[1],c=a[2],l=a[3],u=vt._cs[c];if(l)s.call(u,t,o);else{var f=[u.state,t,o];if(o._forScopeQ)for(var p=0;p<o._forScopeQ.length;p++)f.push(o._forScopeQ[p]);s.apply(u,f)}}}}}while((n=n.parentNode)&&"BODY"!=n.tagName)}function q(e){R("touchstart",e),R("pointerdown",e),Ve=setTimeout(function(){R("press",e)},800),Qe=!1,De=!1;var t=e.touches[0];$e={x:t.clientX,y:t.clientY,t:Date.now()}}function J(e){clearTimeout(Ve),R("touchmove",e),R("pointermove",e),Qe=!0}function U(e){clearTimeout(Ve),De=!0,R("touchcancel",e),R("pointercancel",e)}function H(e){if(clearTimeout(Ve),R("touchend",e),R("pointerup",e),!De)if(Qe){var t=e.changedTouches[0],n=t.clientX,r=t.clientY,i=$e,a=i.x,o=i.y,s=i.t,c=Date.now()-s,l=Math.sqrt((n-a)*(n-a)+(r-o)*(r-o))>>0;if(Be>=c&&l>20){var u=Math.atan2(r-o,n-a),f={slope:u,interval:c,distance:l};R("fling",e,f)}}else R("tap",e),Date.now()-Le<300&&R("dbltap",e),Le=Date.now()}function Y(e){R("mousedown",e),R("pointerdown",e),Ve=setTimeout(function(){R("press",e)},800)}function X(e){clearTimeout(Ve),R("mousemove",e),R("pointermove",e)}function Z(e){clearTimeout(Ve),R("mouseup",e),R("pointerup",e),0===e.button&&(R("click",e),R("tap",e),Date.now()-Re<300&&(R("dblclick",e),R("dbltap",e)),Re=Date.now())}function W(e){clearTimeout(Ve),R("pointercancel",e)}function G(e){R("mouseout",e)}function I(e){R("mousewheel",e)}function K(e,t,n,r,i,a){this.name=e,this.newVal=t,this.oldVal=n,this.path=r,this.type=i,this.object=a}function ee(){this.__eeMap={}}function te(e){ee.call(this),this._uid="C_"+ct++,this.el=e,this.refs={},this.compTags={},this.propTypes=null,this.name,this.parent,this.children=[],this.__watchMap={},this.__watchFn,this.__watchOldVal,this.__watchPaths=[],this.__syncFn={},this.__syncOldVal={},this.__syncFnForScope={},this.template,this.__url,this.state={},vt._cs[this._uid]=this}function ne(){}function re(e,t){var n,r=t._uid;if(a(e.txt)){if(n=document.createElement(e.tag),n._vid=e.vid,e._cid=r,!e._comp){var i=e._directives;i&&i.length>0&&i.forEach(function(n){var r=n[1][0],i=ut[r];if(i){var a=n[1][1],o=n[2],s=n[3];i.onBind&&i.onBind(e,{comp:t,value:o,args:a,exp:s})}})}for(var o in e.attrNodes)o[0]!==tt&&n.setAttribute(o,e.attrNodes[o]);if(e.attrNodes[Ge]&&(t.refs[e.attrNodes[Ge]]=n),e._comp){var s=ve(e,e.tag,n,t,e._slots,e._slotMap,e.attrNodes);e._comp=s}else if(e.children&&e.children.length>0)for(var c=0;c<e.children.length;c++){var s=re(e.children[c],t);n.appendChild(s)}}else n=document.createTextNode(ie(e.txt));return e.dom=n,n}function ie(e){return e.replace?e.replace(/&lt;/gim,"<").replace(/&gt;/gim,">"):e}function ae(e,t){if(a(e.txt)&&!e._comp){var n=e._directives;if(n&&n.length>0&&n.forEach(function(n){var r=n[1][0],i=ut[r];if(i){var a=n[1][1],o=n[2],s=n[3];i.onUpdate&&i.onUpdate(e,{comp:t,value:o,args:a,exp:s},e.dom)}}),e.children&&e.children.length>0)for(var r=0;r<e.children.length;r++)ae(e.children[r],t)}}function oe(e,t){if(t){var n=ue(e,t);if(!ht[e]){if(n.trim().length>0){var r=document.head.children[0];r?r.insertAdjacentHTML("afterend","<style>"+n+"</style>"):document.head.innerHTML="<style>"+n+"</style>"}ht[e]=!0}}}function se(e){e.__url?u(e.name,e.__url,function(n,r){ft[e.name]=n,t(n,e),o(n.state)?e.state=n.state.call(e):n.state&&(e.state={},t(n.state,e.state)),ce(e.template,e),oe(e.name,r),e.__url=null,fe(e),pe(e)}):(e.template&&ce(e.template,e),fe(e))}function ce(e,t){t.onBeforeCompile&&(e=t.onBeforeCompile(e)),t.compiledTmp=e=e.replace(/^\s+|\s+$/gim," ").replace(/>\s([^<]*)\s</,function(e,t){return">"+t+"<"})}function le(e,t,n){(t||n)&&e.forEach(function(e){var r=e[0],i=e[1],a=e[2],o=r.children.indexOf(i),s=[o,1];a?s.push(n[a]):s=s.concat(t),r.children.splice.apply(r.children,s)})}function ue(e,t){t=t.replace(/\n/gim,"").trim();for(var n=!1,r="",i="",a={},o=[],s=0;s<t.length;s++){var c=t[s];if(n)"}"===c&&(n=!1,a.body=i.trim(),r="",o.push(a),a={}),i+=c;else{if("{"===c){n=!0,a.selector=r.trim(),i="";continue}r+=c}}var l="";return e="."+e,o.forEach(function(t){for(var n=t.selector.split(","),r="",i=0;i<n.length;i++){var a=n[i].trim();r+=0===a.indexOf(":host")?","+a.replace(/:host/,e):","+e+" "+a}r=r.substr(1),l+=r+"{"+t.body+"}"}),l}function fe(e){var t=j(e),n=null;if(e.vnode){n=e.vnode.parent;var r=n.children,i=r.indexOf(e.vnode);i>-1&&r.splice(i,1,t)}e.vnode=t,t.parent=n,e.state=Se.observe(e.state,e),e.onCompile&&e.onCompile(e.vnode)}function pe(e,t){var n=re(e.vnode,e);e.onBeforeMount&&e.onBeforeMount(n),e.el.parentNode.replaceChild(n,e.el),e.el=n;for(var r=e.children.length;r--;)se(e.children[r]);for(var r=0;r<e.children.length;r++)e.children[r].__url||pe(e.children[r],e.vnode);if(e.name){var i=e.el.className.replace(/\s+$/,"");i.split(" ").indexOf(e.name)<0&&(e.el.className=i+" "+e.name),e.vnode.setAttribute("class",e.el.className),e.el.setAttribute(ot,e.name),e.vnode.setAttribute(ot,e.name)}e.onMount&&e.onMount(e.el),e.vnode.parent=t,ae(e.vnode,e)}function he(e,t){var r=!0;if(e.onBeforeUpdate&&(r=e.onBeforeUpdate(t)),r!==!1){var i=j(e);e.onCompile&&e.onCompile(i);var a=T(i,e.vnode,e,a);if(e.__watchFn){var o=e.__watchFn(e.state);for(var s in o){var c=o[s],l=e.__watchOldVal[s];(c!==l||n(c))&&e.__watchMap[s].call(e,c,l,s)}e.__watchOldVal=o}for(var u in e.__syncFn){var f=[e.state];a[u]&&(e.__syncFnForScope[u]=a[u]);var p=e.__syncFnForScope[u];if(p)for(var h=0;h<p.length;h++)f.push(p[h]);var d=e.__syncFn[u].apply(e,f);vt._cs[u].onPropChange&&vt._cs[u].onPropChange(d,e.__syncOldVal[u]),e.__syncOldVal[u]=d}e.onUpdate&&e.onUpdate(),ae(e.vnode,e)}}function de(e,n,r){var i=new te(n);return i.compiledTmp=e,r&&(t(r,i),o(r.state)&&(i.state=r.state.call(i))),i}function ve(e,n,r,a,s,c,l){"component"==n&&(n=l.is,l[".is"]&&(n=l[".is"],n=new Function("scope","with(scope){return "+n+"}")(a.state)));var u=ft[n];if(u){var f=new te(r);return f.name=n,a.children.push(f),f.parent=a,f.vnode=e,l[Ge]&&(a.refs[l[Ge]]=f),l[Ie]&&(vt.g[l[Ie]]=f),e._directives.forEach(function(e){var t=e[1][0];if("on"===t){var n=e[1][1][0],r=e[2];r.match(/(?:^|this\.)([a-zA-Z_][a-zA-Z0-9_$]*)(?:\(|$)/);var i=RegExp.$1,o=a[i];f.on(n,o)}}),f.onCreate&&f.onCreate(),me(f,a,l),f.__slots=s,f.__slotMap=c,i(u)?(f.__url=u,f):(u&&(t(u,f),o(u.state)?f.state=u.state.call(f):u.state&&(f.state={},t(u.state,f.state))),f.compiledTmp=u.template,f)}}function me(e,t,n){var r={},i=e.propTypes;if(i)for(var a in i){var o=i[a];o.require&&(r[a]=o)}n&&_e(n,e,t,i,r);var s=Object.keys(r);return s.length>0?void ye("props ["+s.join(",")+"] of component["+e.name+"] are required"):void 0}function _e(e,r,i,a,o){var s="",c={};for(var l in e){var u=e[l];if(l!=Ge)if(l=l.replace(/-[a-z0-9]/g,function(e){return e[1].toUpperCase()}),l[0]===Ke){var f=l.substr(1);i[u]instanceof Function&&(u="this."+u),s+=","+JSON.stringify(f)+":"+u}else c[l]=u}s=s.substr(1);var p="",h="",d=r.vnode,v=[i.state],m=i.__syncFnForScope[r._uid]=[];if(d._forScopeQ)for(var _=0;_<d._forScopeQ.length;_++)p+="with(arguments["+(1+_)+"]){",h+="}",v.push(d._forScopeQ[_]),m.push(d._forScopeQ[_]);var g=i.__syncFn[r._uid]=new Function("scope","with(scope){"+p+"return {"+s+"}"+h+"}"),b=i.__syncOldVal[r._uid]=g.apply(i,v),y=[];t(c,b);for(var l in b){var u=b[l];n(u)&&u.__im__oid&&y.push(l),a&&l in a&&(delete o[l],ge(l,u,a,r))}if(y.length>0&&be("ref parameters '"+y.join(",")+"' should be read only"),r.onPropBind)r.onPropBind(b);else for(var l in b){var u=b[l];u instanceof Function?r[l]=u:r.state[l]=u}}function ge(e,t,n,r){if(n[e]&&n[e].type){var i=n[e].type;i=i instanceof Array?i:[i];var a=typeof t;t instanceof Array&&(a="array"),"undefined"!==a&&i.indexOf(a)<0&&ye("invalid type ["+a+"] of prop ["+e+"] of component["+r.name+"];should be ["+i.join(",")+"]")}}function be(e){console&&console.warn("impex warn :: "+e)}function ye(e){console&&console.error("impex error :: "+e)}function we(e,t,n){var r=(e.target||e.srcElement).value;if(a(t.toNum)||(r=parseFloat(r)),t.debounce){t.debounceTimer&&(clearTimeout(t.debounceTimer),t.debounceTimer=null);var i=this;t.debounceTimer=setTimeout(function(){clearTimeout(t.debounceTimer),t.debounceTimer=null,i.setState(t.exp,r)},t.debounce)}else this?this.setState(t.exp,r):n.setState(t.exp,r)}function xe(e,t,n){var i=e.target||e.srcElement,a=i.value,o="with(scope){return "+t.exp+"}",s=new Function("scope",o),c=null;if(c=s(this?this.state:n.state),r(c)||(c=[c]),i.checked)c.push(a);else{var l=c.indexOf(a);l>-1&&c.splice(l,1)}}var Oe={},Se=null;window.Proxy&&!function(){function e(e,t,n){isNaN(t)||(e[t>>0]=n)}function t(e,t){isNaN(t)||e.splice(t,1)}function i(e,t,a,o){if(a&&a.__im__propChain)return a;var s=r(a)?[]:{};for(var c in a){var l=a[c];if(n(l)){var u=t.concat();u.push(c);var f=i(e,u,l,o);s[c]=f}else s[c]=l}Object.defineProperty(s,"__im__propChain",{enumerable:!1,writable:!1,value:t});var p=new Proxy(s,e),h=Date.now()+Math.random();return Object.defineProperty(s,"__im__oid",{enumerable:!1,writable:!1,value:h}),p}Se={observe:function(a,o){if(a&&a.__im__propChain)return a;var s={comp:o,set:function(t,a,o){var s=!(a in t),c=t[a],l=o;if(c===l)return!0;if(n(l)){var u=t.__im__propChain.concat();u.push(a),l=i(this,u,l,this.comp)}r(t)?e(t,a,l):t[a]=l;var f=t.__im__propChain,p={object:t,name:a,pc:f,oldVal:c,newVal:l,comp:this.comp,type:s?"add":"update"};return Je.handle(p),!0},deleteProperty:function(e,n){var i=e[n];r(e)?t(e,n):delete e[n];var a=e.__im__propChain,o={object:e,name:n,pc:a,oldVal:i,comp:this.comp,type:"delete"};return Je.handle(o),!0}};return i(s,[],a,o)}}}(),!window.Proxy&&!function(){function e(e){return this.__im__innerProps[e]}function t(e,t){var r=this.__im__innerProps[e];if(r&&o(r),n(t)){var a=this.__im__propChain.concat();a.push(e),t=i(a,t,this.__im__comp)}this.__im__innerProps[e]=t;this.__im__propChain;s([{name:e,target:this,oldVal:r,newVal:t,type:"update"}],!0)}function i(a,o,s){if(o&&o.__im__propChain)return o;var l=r(o)?[]:{};Object.defineProperty(l,"__im__innerProps",{enumerable:!1,writable:!0,value:{}});var u={},f={};for(var p in o)if(o.hasOwnProperty(p)){var h=o[p];if(n(h)){var d=a.concat();d.push(p);var v=i(d,h,s);l.__im__innerProps[p]=v}else l.__im__innerProps[p]=h;f[p]=h,!function(n){u[n]={get:function(){return e.call(this,n)},set:function(e){t.call(this,n,e)},enumerable:!0,configurable:!0}}(p)}Object.defineProperties(l,u),Object.defineProperty(l,"__im__propChain",{enumerable:!1,writable:!1,value:a}),Object.defineProperty(l,"__im__comp",{enumerable:!1,writable:!1,value:s});var m=Date.now()+Math.random();return Object.defineProperty(l,"__im__oid",{enumerable:!1,writable:!1,value:m}),c.push({snap:f,now:l,id:m}),l}function a(){l(function(){for(var e=c.length;e--;){var t=c[e],n=t.snap,r=t.now,i=(t.id,[]);for(var o in n)if(!(o in r)){var l={};l.name=o,l.target=r,l.oldVal=n[o],l.snap=n,l.type="delete",i.push(l)}for(var o in r)if(!(o in n)){var l={};l.name=o,l.target=r,l.newVal=r[o],l.snap=n,l.type="add",i.push(l)}i.length>0&&s(i)}a()})}function o(e){for(var t=null,r=c.length;r--&&(t=c[r],t.id!==e.__im__oid););r>-1&&(c.splice(r,1),n(t)&&o(t))}function s(r,a){for(var s=r.length;s--;){var c=r[s],l=c.name,u=c.target,f=u.__im__propChain,p=u.__im__comp,h=c.oldVal,d=c.newVal,v=c.type,m=c.snap;if("add"===v){if(m[l]=d,u.__im__innerProps[l]=d,n(d)){var _=f.concat();_.push(l),u.__im__innerProps[l]=i(_,d,p)}!function(n,r){Object.defineProperty(r,n,{get:function(){return e.call(this,n)},set:function(e){t.call(this,n,e)},enumerable:!0,configurable:!0})}(l,u)}else if("delete"===v){var g=m[l];n(g)&&o(g),delete m[l]}else if(!a){console.log("无效update");continue}var b={object:u,name:l,pc:f,oldVal:h,newVal:d,comp:p,type:v};Je.handle(b)}}var c=[],l=function(e){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||function(t){return e.setTimeout(function(){t(Date.now())},16.7)}}(self);Se={},Se.observe=function(e,t){return e&&e.__im__propChain?e:i([],e,t)},a()}();var Ne=0;h.prototype={on:function(e,t){var n=pt[e];n||(n=pt[e]={});var r=!1;if(o(t)&&(r=!0),r)n[this.vid]=[this,t,this._cid,r];else{var i="",a="";if(this._forScopeQ)for(var s=0;s<this._forScopeQ.length;s++)i+="with(arguments["+(3+s)+"]){",a+="}";n[this.vid]=[this,new Function("scope,$event,$vnode","with(scope){"+i+t+a+"}"),this._cid]}},setAttribute:function(e,t){return this.attrNodes[e]=t,this},getAttribute:function(e){return this.attrNodes[e]}};var ke=[],Ee=["br","hr","img","input","link","meta","area","base","col","embed","keygen","param","source","track","wbr"],Ce=null,Ae=self.navigator.userAgent.toLowerCase(),Fe=Ae.indexOf("android")>0?!0:!1,je=Ae.indexOf("iphone")>0?!0:!1,Te=Ae.indexOf("ipad")>0?!0:!1,Pe=Ae.indexOf("windows phone")>0?!0:!1,Me=je||Te||Fe||Pe;if(Me){var Ve,$e,Be=200,Le=0,Qe=!1,De=!1;document.addEventListener("touchstart",q,!0),document.addEventListener("touchmove",J,!0),document.addEventListener("touchend",H,!0),document.addEventListener("touchcancel",U,!0)}else{document.addEventListener("mousedown",Y,!0),document.addEventListener("mousemove",X,!0),document.addEventListener("mouseup",Z,!0),window.addEventListener("blur",W,!0);var ze=null==self.onmousewheel?"mousewheel":"DOMMouseScroll";document.addEventListener(ze,I,!0),document.addEventListener("mouseout",G,!0);var Ve,Re=0}document.addEventListener("input",function(e){R("input",e)},!0),document.addEventListener("change",function(e){R("change",e)},!0),document.addEventListener("keydown",function(e){R("keydown",e)},!0),document.addEventListener("keypress",function(e){R("keypress",e)},!0),document.addEventListener("keyup",function(e){R("keyup",e)},!0),document.addEventListener("focus",function(e){R("focus",e)},!0),document.addEventListener("blur",function(e){R("blur",e)},!0);var qe=null==self.onwheel?"wheel":"mousewheel";document.addEventListener(qe,function(e){R("wheel",e)},!0),document.addEventListener("scroll",function(e){R("scroll",e)},!0);var Je=new function(){function e(e){for(var t=i.length;t--;){var n=i[t];if(n.object.__im__oid===e.object.__im__oid&&n.name===e.name)break}t>-1?i.splice(t,1,e):i.push(e)}function t(e,t,n,i,o,s,c){var l=[];if(l=c.concat(),r(s)||l.push(o),n){a[n._uid]||(a[n._uid]={changes:[],comp:n});var u=new K(o,e,t,l,i,s);a[n._uid].changes.push(u)}}var n=!1,i=[],a={};this.handle=function(r){n?e(r):(i=[],a={},n=!0,i.push(r),setTimeout(function(){n=!1,i.forEach(function(e){var n=e.comp,r=e.newVal,i=e.oldVal,a=e.pc,o=e.type,s=e.name,c=e.object;t(r,i,n,o,s,c,a)});var e=a;for(var r in e)he(e[r].comp,e[r].changes)},20))}};ee.prototype={on:function(e,t){this.__eeMap[e]=t},emit:function(e){var t=this.__eeMap[e];if(t){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);t.apply(this,n)}}},ne.prototype=ee.prototype,te.prototype=new ne,te.prototype.constructor=te.constructor,t({setState:function(e,t){t=JSON.stringify(t);var n="with(scope){"+e+"="+t+"}",r=new Function("scope",n);return r(this.state),this},watch:function(e,t){this.__watchPaths.push(e);for(var n="",r=this.__watchPaths.length;r--;){var i=this.__watchPaths[r];n+=","+JSON.stringify(i)+":"+i}n=n.substr(1);var a=this.__watchFn=new Function("scope","with(scope){return {"+n+"}}");return this.__watchOldVal=a(this.state),this.__watchMap[e]=t,this},destroy:function(){if(this.onDestroy&&this.onDestroy(),this.parent){this.parent.__syncFn[this._uid]=null,this.parent.__syncOldVal[this._uid]=null,this.parent.__syncFnForScope[this._uid]=null,delete this.parent.__syncFn[this._uid],delete this.parent.__syncOldVal[this._uid],delete this.parent.__syncFnForScope[this._uid];var e=this.parent.children.indexOf(this);e>-1&&this.parent.children.splice(e,1),this.parent=null}for(;this.children.length>0;)this.children[0].destroy();this.children=vt._cs[this._uid]=null,delete vt._cs[this._uid],this.refs=this.__nodes=this.__syncFn=this._uid=this.__url=this.template=this.state=null},onPropChange:function(e,t){for(var r in e){var i=e[r];if(n(i)){var a=i instanceof Array?[]:{};this.state[r]=Object.assign(a,i)}else i!==this.state[r]&&(this.state[r]=i)}}},te.prototype);var Ue="x-",He=":",Ye=".",Xe="{{",Ze="}}",We=/^x-.*/,Ge="ref",Ie="impex-g",Ke=".",et=":",tt=".",nt="=>",rt="=&gt;",it="|",at=":",ot="data-impex-compoment",st="slot",ct=0,lt={},ut={},ft={component:1},pt={},ht={},dt=!0,vt=new function(){this.g={},this.version={v:[0,96,0],state:"alpha",toString:function(){return vt.version.v.join(".")+" "+vt.version.state}},this.website="http://impexjs.org",this.config=function(e){var t=e.delimiters||[];Xe=t[0]||"{{",Ze=t[1]||"}}",dt=e.showWarn===!1?!1:!0},this.component=function(e,t){return"string"==typeof t||t.template||ye("can not find property 'template' of component '"+e+"'"),ft[e]=t,this},this.directive=function(e,t){return ut[e]=t,this},this.filter=function(e,t){return lt[e]=t,this},this.renderTo=function(e,t,n){for(var r=document.querySelectorAll('link[rel="impex"]'),a=r.length;a--;){var o=r[a],s=o.getAttribute("type"),c=o.getAttribute("href");vt.component(s,c)}if(i(t)&&(t=document.querySelector(t)),"BODY"===t.tagName)return void ye("container element must be inside <body> tag");e=e.replace(/<!--[\s\S]*?-->/gm,"").replace(/<\s*script[\s\S]*?<\s*\/\s*script\s*>/gm,"").trim();var l=de(e,t,n);return l.onCreate&&l.onCreate(),se(l),pe(l),l},this.render=function(e,t){i(e)&&(e=document.querySelector(e));var n=e.outerHTML;return this.renderTo(n,e,t)},Object.defineProperty(this,"_cs",{enumerable:!1,writable:!0,value:{}}),this.Component=te,this.EventEmitter=ee};vt.directive("style",{onBind:function(e,t){var n=t.value;if(i(n)){for(var r={},a=n.split(";"),o=a.length;o--;)if(a[o]){var s=a[o].split(":");r[s[0]]=s[1]}n=r}var c=e.getAttribute("style")||"";for(var l in n){var u=this.filterName(l),f=n[l];u=u.replace(/[A-Z]/gm,function(e){return"-"+e.toLowerCase()}),c+=u+":"+f+";"}e.setAttribute("style",c)},filterName:function(e){return e.replace(/-([a-z])/gim,function(e,t){return t.toUpperCase()})}}).directive("class",{onBind:function(e,t){var n=t.value,a=e.getAttribute("class")||"";if(i(n))a+=" "+n;else if(r(n))a+=" "+n.join(" ");else for(var o in n){var s=n[o];s&&(a+=" "+o)}e.setAttribute("class",a)}}).directive("on",{onBind:function(e,t){for(var n=t.args,r=n.length;r--;)e.on(n[r],t.value)}}).directive("bind",{onBind:function(e,t){var n=t.args;(!n||n.length<1)&&be("at least one attribute be binded");for(var r=n.length;r--;){var i=n[r];switch(i){case"style":ut[i].onBind(e,t);break;case"class":ut[i].onBind(e,t);break;default:e.setAttribute(i,t.value)}}}}).directive("show",{onBind:function(e,t){var n=t.value,r=e.getAttribute("style")||"";r+=n?";display:;":";display:none;",e.setAttribute("style",r)}}).directive("model",{onBind:function(e,t){e.toNum=e.getAttribute("number"),e.debounce=e.getAttribute("debounce")>>0,e.exp=t.exp,e.on("change",this.handleChange),e.on("input",we)},handleChange:function(e,t){{var n=e.target,r=n.tagName.toLowerCase();n.value}switch(r){case"textarea":case"input":var i=n.getAttribute("type");switch(i){case"radio":we(e,t,this);break;case"checkbox":xe(e,t,this)}break;case"select":var a=n.getAttribute("multiple");if(null!==a){for(var o=[],s=n.options.length;s--;){var c=n.options[s];c.selected&&o.push(c.value)}this.setState(t.exp,o)}else we(e,t,this)}}}),vt.filter("json",function(e){return JSON.stringify(e)}).filter("filterBy",function(e,t,n){var i=e;if(!r(i))return be("can only filter array"),e;var a=[];if(o(t))for(var s=i.length;s--;){var c=t.call(this,i[s]);c&&a.unshift(i[s])}else for(var s=i.length;s--;){var l=i[s];n?(!t||(l[n]+"").indexOf(t)>-1)&&a.unshift(l):(!t||l.indexOf&&l.indexOf(t)>-1)&&a.unshift(l)}return a}).filter("limitBy",function(e,t,n){return r(e)?t?e.splice(n||0,t):e:(be("can only filter array"),e)}).filter("orderBy",function(e,t,n){return t||n?r(e)?(e.sort(function(e,n){var r=t?e[t]:e,i=t?n[t]:n;return"string"==typeof r?r.localeCompare(i):"number"==typeof r?r-i:(r+"").localeCompare(i)}),"desc"===n&&e.reverse(),e):(be("can only filter array"),e):e}),"object"==typeof module&&"object"==typeof module.exports?module.exports=vt:e.impex=vt;

}(window||this);