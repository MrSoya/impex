/*
 * impexjs is a powerful web application engine to build 
 * reactive webUI system
 *
 *
 * Copyright 2015-2019 MrSoya and other contributors
 * Released under the MIT license
 *
 * website: http://impexjs.org
 * last build: 2019-2-11
 */
!function(t){"use strict";function e(t,e){for(var n=Object.keys(t),r=n.length;r--;){var i=n[r];e[i]=t[i]}}function n(t){return"object"==typeof t&&null!==t}function r(t){return Array.isArray(t)}function i(t){return"string"==typeof t}function o(t){return void 0===t}function a(t){return t instanceof Function}function s(t){for(var e,n,r=null,i=[],o=[],a=[],s=[];t.length>0;){if(!r){r=qt.exec(t);var l=r.index+r[0].length;t=t.substr(l)}var f=r[1],h=new R(f);h.outerHTML=r[0],h.innerHTML=t;var p=i[i.length-1];p?p.children.push(h):a.push(h),Rt[f]&&(n=h,o.push(h));var d=r[2].trim(),v=d.match(Vt);if(v&&c(v,h,n),t.length<1)break;if(f===Jt)s.push([p,h,h.attributes.name?h.attributes.name:null]);else if(h.attributes.slot){var m=n;m===h&&(m=o[o.length-1-1]),m&&(m.slotMap[h.attributes.slot]=h)}It.indexOf(f)<0?i.push(h):h.innerHTML="";var g=qt.exec(t);g&&(r=g),e=Yt.exec(t);var b=e?e.index:-1,_=g?g.index:-1;if(p=i[i.length-1],_>-1&&b>_)u(t.substr(0,_),p),t=t.substr(_+g[0].length);else{u(t.substr(0,b),p);var y=b+e[0].length;Zt.lastIndex=0,Zt.exec(t);do{var w=i.pop();if(w===n&&(o.pop(),n=o[o.length-1]),w===h)if(h.innerHTML==e.input)h.innerHTML=e.input.substring(0,e.index);else{var x=h.innerHTML.replace(e.input,"");h.innerHTML=x+e.input.substring(0,e.index)}if(i.length<1)break;e=Zt.exec(t),b=e.index;var $=t.substring(y,e.index);if($.trim()){if(b>_){var w=qt.exec($);w&&($=$.substr(0,w.index).trim())}$.trim()&&(h=i[i.length-1],u($,h))}y=b+e[0].length}while(_>b);if(!g)break;t=t.substr(_+g[0].length)}}return[a,s]}function c(t,e,n){for(var i=t.length;i--;){var o,a=t[i],s=a.indexOf("="),c=null;0>s?o=a:(o=a.substring(0,s),c=a.substring(s+2,a.length-1));var u=[o,c],p=f(o,e,n&&e==n);if(p){var d=null,v=null;if(c){c=c.replace(/&amp;/gm,"&");var m,s=c.indexOf("=>");0>s?d=c:(d=c.substring(0,s),m=c.substring(s+2,c.length)),d=d.trim(),v=l(m)}var g=r(p)?p[0]:p,b=!0;switch(g){case"for":e["for"]=h(d,v,u,n),b=!1;break;case"if":e["if"]=d,b=!1;break;case"else-if":e.elseif=d,b=!1;break;case"else":e["else"]=!0,b=!1;break;case"html":e.html=d,b=!1}b&&(u.push({dName:g,dArgsAry:p[1],dFilter:p[2]}),u.push({vExp:d,vFilterAry:v}),e.directives[o]=u)}else e.attributes[o]=c}}function u(t,e){t=t.trim();var n=[];if(t){for(var r=null,i=0;r=Ht.exec(t);){var o=t.substring(i,r.index);o&&n.push(o),n.push([r[1],l(r[2],!0)]),i=r.index+r[0].length}i<t.length&&n.push(t.substr(i)),n.length<1&&n.push(t);var a=new R;a.txtQ=n,e.children.push(a)}}function l(t,e){var n=[];if(t)for(var r=t.split("|"),i=0;i<r.length;i++){var o=r[i].split(":");n.push({name:o[0].trim(),param:o.slice(1)})}return n}function f(t,e,n){var r=null,i=null,o=null;if(St.test(t)){var a=t.replace(Ot,""),s=a.indexOf(Tt);s>-1&&(a=a.substring(0,s)),r=a;var c=t.indexOf(Tt);switch(c>-1&&(i=t.substr(c+1)),a){case"if":case"else-if":case"else":case"for":case"html":return a}}else t[0]===jt?(r="on",i=t.substr(1)):t[0]!==Qt||n||(r="bind",i=t.substr(1));if(i){var u=i.indexOf(kt);u>-1&&(o=i.substr(u+1),i=i.substring(0,u)),i=i.split(Tt)}return r?[r,i,o]:r}function h(t,e,n,r){var i=null,o=e,a=RegExp.$2,s=a.split(","),c=s.length>1?s[0]:null,u=s.length>1?s[1]:s[0],l=RegExp.$1;return i=l.match(/^([\s\S]*?)\s+to\s+([\s\S]*?)$/)?[c,u,o,RegExp.$1,RegExp.$2]:[c,u,o,l]}function p(t,e){if(Wt[t]&&!e._slots&&!e._slotMap)return Wt[t];var n="with(comp){return "+d(t,e,[])+"}";return n=new Function("comp,_ce,_tmp,_ct,_li,_fi",n),Wt[t]=n,n}function d(t,e,n){var r=s(t),i=r[0],o=i[0];v(r[1],e._slots,e._slotMap);var t=m(o,n);return t}function v(t,e,n){(e||n)&&t.forEach(function(t){var r=t[0],i=t[1],o=t[2],a=r.children.indexOf(i),s=[a,1];o?n[o]&&s.push(n[o]):s=s.concat(e),r.children.splice.apply(r.children,s)})}function m(t,e){var n="";if(t.tag){var r,i;t["for"]&&(r="forScope"+Xt++,e=e.concat(r)),i="["+e.toString()+"]";var o="";if(Gt[t.rid]=t,!Rt[t.tag]){for(var a=!1,s="",c=0;c<t.children.length;c++){var u=t.children[c],l=t.children[c+1],f=m(u,e);if(u["if"]&&!u["for"]&&(a=!0,s=""),a){if(u["else"]){a=!1,o+=","+s+f;continue}if(s&&!u.elseif){a=!1,o+=","+s+"null,"+f;continue}s+=f,(!l||l["if"])&&(o+=","+s+"null")}else o+=","+f}o.length>0&&(o=o.substr(1))}var s=t["if"]||t.elseif,h="",p="";s&&(h="("+s+")?",p=":");var d=g(t.directives),v=t.html||"null",f='_ce(this,"'+t.rid+'",['+o+"],{"+d+"},"+v+","+i;if("template"==t.tag&&(f="_tmp(["+o+"],"+i),f=h+f,t["for"]){var y=(t["for"][0]||"").trim(),w=t["for"][1].trim(),x=t["for"][2],$=t["for"][3],E=t["for"][4],A=$,O="";if(t.attributes["var"]){O=t.attributes["var"];var T=O.replace(/^{|}$/gm,"").split(","),k="";T.forEach(function(t){var e=t.split(":");k+="var "+e[0]+"="+e[1]+";"}),O=k}E&&(A="(function(){var rs=[];for(var i="+$+";i<="+E+";i++)rs.push(i);return rs;}).call(this)"),x.length>0&&(A="_fi("+A+","+_(x)+",comp)"),n="_li("+A+",function("+r+"){with("+r+"){"+O+" return "+f+")"+(p?":null":"")+'}},this,"'+y+'","'+w+'")'}else n=f+")"+p}else{var L=b(t.txtQ);n+="_ct("+L+")"}return n}function g(t){var e="";for(var n in t){var r=t[n],i=r[3].vExp,o=r[2].dName,a="on"===o||"model"===o?JSON.stringify(i):i;e+=',"'+n+'":'+(a||"null")}return e.substr(1)}function b(t){var e="";return t.forEach(function(t){if(t instanceof Array){var n=t[0],r=t[1];e+=r.length>0?"+_fi("+n+","+_(r)+",comp)":"+("+n+")"}else t&&(e+="+"+JSON.stringify(t))}),e=e.replace(/\n/gm,""),e.length>0&&(e=e.substr(1)),e}function _(t){var e="";return t.forEach(function(t){var n='["'+t.name+'",['+t.param.toString()+"]]";e+=","+n}),"["+e.substr(1)+"]"}function y(t,e){var n=e.target,r=!1;do{var i=n._vid;if(void 0!==i){var o=zt[t];if(o){var a=o[i];if(a){var s=a[0];if("mouseleave"==t){var c=e.target;if(!w(s.dom,c))return;var u=e.toElement||e.relatedTarget;if(w(s.dom,u))return;var l=Kt.indexOf(s);l>-1&&Kt.splice(l,1)}if("mouseenter"==t){var c=e.target,f=e.relatedTarget;if(w(s.dom,c)&&s.dom!=c&&Kt.indexOf(s)>-1)return;if(f&&w(s.dom,f))return;Kt.push(s)}var h=a[1];if(0!==t.indexOf("key")||!h||e.key.toLowerCase()==h){var p=a[2],d=a[3],v=a[4],m=Ee._cs[d];if(v)p.call(m,e,s);else{var g=[m,e,s];if(s._forScopeQ)for(var l=0;l<s._forScopeQ.length;l++)g.push(s._forScopeQ[l]);p.apply(m,g)}r=e.cancelBubble}}}}}while((n=n.parentNode)&&"BODY"!=n.tagName&&!r)}function w(t,e){if(t.contains)return t.contains(e);do{if(t==e)return!0;e=e.parentNode}while(e&&"BODY"!=e.tagName);return!1}function x(t){y("touchstart",t),y("pointerdown",t),ae=setTimeout(function(){y("press",t)},800),le=!1,fe=!1;var e=t.touches[0];se={x:e.clientX,y:e.clientY,t:Date.now()}}function $(t){clearTimeout(ae),y("touchmove",t),y("pointermove",t),le=!0}function E(t){clearTimeout(ae),fe=!0,y("touchcancel",t),y("pointercancel",t)}function A(t){if(clearTimeout(ae),y("touchend",t),y("pointerup",t),!fe)if(le){var e=t.changedTouches[0],n=e.clientX,r=e.clientY,i=se,o=i.x,a=i.y,s=i.t,c=Date.now()-s,u=Math.sqrt((n-o)*(n-o)+(r-a)*(r-a))>>0;if(ce>=c&&u>20){var l=Math.atan2(r-a,n-o),f={slope:l,interval:c,distance:u};y("fling",t,f)}}else y("tap",t),Date.now()-ue<300&&y("dbltap",t),ue=Date.now()}function O(t){y("click",t),y("tap",t)}function T(t){y("dblclick",t),y("dbltap",t)}function k(t){y("mousedown",t),y("pointerdown",t),ae=setTimeout(function(){y("press",t)},800)}function L(t){clearTimeout(ae),y("mousemove",t),y("pointermove",t)}function M(t){clearTimeout(ae),y("mouseup",t),y("pointerup",t)}function S(t){clearTimeout(ae),y("pointercancel",t)}function C(t){y("mouseout",t),y("mouseleave",t);var e=t.target,n=[];Kt.forEach(function(r){if(w(r.dom,e)){var i=t.toElement||t.relatedTarget;w(r.dom,i)||n.push(r)}}),n.forEach(function(t){var e=Kt.indexOf(t);Kt.splice(e,1)})}function B(t){y("mouseover",t),y("mouseenter",t)}function D(t){y("mousewheel",t)}function j(t,e,n,r,i){this.name=t,this.newVal=e,this.oldVal=n,this.type=r,this.object=i}function Q(t,e){this.key,this.handler=t,this.component=e,this.monitors=[],e._watchers.push(this)}function H(){this.key,this.target,this.value,this.watchers=[]}function N(t,e){e.$state=U(t,null,e,!0)}function U(t,e,r,i){var o=Array.isArray(t)?P([],r,e):{};for(var a in t){var s=t[a],c=null;if(e&&e.value){var u=Object.getOwnPropertyDescriptor(e.value,a);u&&u.get&&(c=u.get.__mm__)}var u=Object.getOwnPropertyDescriptor(t,a);u&&u.get&&(c=u.get.__mm__),c||(c=new H),n(s)&&(s=U(s,c,r,!1)),F(a,s,o,r,i,c)}return o}function F(t,e,r,i,o,a){a.key=t,a.target=r,a.value=e;var s=function(){return a.collect(),a.value};Object.defineProperty(s,"__mm__",{value:a});var c={enumerable:!0,configurable:!0,get:s,set:function(t){t!==a.value&&(n(t)&&(t=U(t,a,i,!1),Array.isArray(t)&&(t=P(t,i,a))),a.notify(t,"update"))}};return Object.defineProperty(r,t,c),o&&Object.defineProperty(i,t,c),a}function P(t,e,n){return t.push!==de?t:(Object.defineProperties(t,{push:{value:function(){var t=this.length,r=de.apply(this,arguments);if(r>t){var i=U(this,n,e,!1);n.notify(i,"add")}return r}},pop:{value:function(){var t=this.length,e=ve.call(this);return this.length<t&&n.notify(this,"del"),e}},unshift:{value:function(){var t=this.length,r=ge.apply(this,arguments);if(r>t){var i=U(this,n,e,!1);n.notify(i,"add")}return r}},shift:{value:function(){var t=this.length,e=me.call(this);return this.length<t&&n.notify(this,"del"),e}},splice:{value:function(){var t=null;arguments[1]>-1&&(t="del"),arguments.length>2&&(t="del"==t?"update":"add");var r=this.length,i=be.apply(this,arguments);if("del"!=t){{U(this,n,e,!1)}n.notify(this,t)}return(i&&i.length>0||r!=this.length)&&n.notify(this,t),i}},reverse:{value:function(){return this.length<1?this:(_e.call(this),n.notify(this,"update"),this)}},sort:{value:function(t){return this.length<1?this:(ye.call(this,t),n.notify(this,"update"),this)}}}),t)}function R(t){this.rid=xe++,this.tag=t,this.children=[],this.directives={},this.attributes={},this.txtQ,this.slotMap={},this.outerHTML,this.innerHTML}function z(t,e){this.tag=t,this.txt,this.children=[],this.dom,this.vid=we++,this.attributes,this.directives=[],this._hasEvent,this._slots,this._comp,this._forScopeQ,this.raw=e}function I(t,e,n,r,i,o){var a=Gt[e],s=a.tag,c=new z(s,a);for(var u in a.directives){var l=a.directives[u];l[1]=r[u],c.directives.push([l[0],l[1],l[2],l[3]])}if(c.attributes=Object.assign({},a.attributes),c._isEl=!0,o.length>0&&(c._forScopeQ=o),Rt[s]||"component"==s)return c._comp=!0,c._slots=a.children,c._slotMap=a.slotMap,c;if(null!=i){{var f,h,p="",v="",m=[t,I,q,V,Y,Z],g=[];m.length}if(c._forScopeQ)for(var b=0;b<c._forScopeQ.length;b++){var _="forScope"+Xt++;p+="with("+_+"){",v+="}",m.push(c._forScopeQ[b]),g.push(_)}h=d("<"+s+">"+i+"</"+s+">",t,g);var y=g.length>0?","+g.toString():"",w=new Function("comp,_ce,_tmp,_ct,_li,_fi"+y,"with(comp){"+p+"return "+h+";"+v+"}");f=w.apply(t,m),n=f.children||[]}return n.length>0&&(c.children=[],n.forEach(function(t){t&&(t instanceof Array?t.forEach(function(t){t.parent=c,c.children.push(t)}):(t.parent=c,c.children.push(t)))})),c}function q(t,e){var n=null;e&&(n=[e]);var r=[];return t.length>0&&t.forEach(function(t){if(t)if(t instanceof Array)t.forEach(function(t){if(r.push(t),n){var e=t._forScopeQ;t._forScopeQ=e?n.concat(e):n}});else if(r.push(t),n){var e=t._forScopeQ;t._forScopeQ=e?n.concat(e):n}}),r}function V(t){var e=new z;return e.txt=t&&t.toString?t.toString():t,e}function Y(t,e,n,i,o){var a=[];return t.forEach(function(t,s){var c={$index:s};i&&(c[i]=s),c[o]=t;var u=e.call(n,c);u&&(r(u)?a=a.concat(u):a.push(u))}),a}function Z(t,e,n){for(var r=0;r<e.length;r++){var i=e[r],o=Ft[i[0]];o||(o=n[i[0]]);var a=i[1];a.unshift(t),t=o.apply(n,a)}return t}function J(t,e){var n,r=e.$id;if(t._isEl){if(n=document.createElement(t.tag),n._vid=t.vid,t._cid=r,!t._comp){var i=t.directives;t._comp_directives&&(i=i.concat(t._comp_directives)),i&&i.length>0&&i.forEach(function(n){var r=pt(n,e),i=r[0];i.onBind&&i.onBind(t,r[1])})}for(var o in t.attributes)if(o[0]!==Qt){var a=t.attributes[o];n.setAttribute(o,a)}if(t.attributes[Ct]&&(e.$ref[t.attributes[Ct]]=n),t._comp){var s=X(t,t.tag,n,e,t._slots,t._slotMap,t.attributes);t._comp=s}else if(t.children&&t.children.length>0)for(var c=0;c<t.children.length;c++){var s=J(t.children[c],e);n.appendChild(s)}}else n=document.createTextNode(W(t.txt));return t.dom=n,n}function W(t){return t&&t.replace?t.replace(/&lt;/gim,"<").replace(/&gt;/gim,">").replace(/&nbsp;/gim,"Â ").replace(/&amp;/gim,"&"):t}function X(t,e,n,r,i,o,a){"component"==e&&(e=a.is,a[".is"]&&(e=a[".is"],e=new Function("scope","with(scope){return "+e+"}")(r)));var s=new ft(n);return s.$name=e,r.$children.push(s),s.$parent=r,s.$root=r.$root,s.$vnode=t,s._props=a,a[Ct]&&(r.$ref[a[Ct]]=s),a[Bt]&&(Ee.id[a[Bt]]=s),t.directives.forEach(function(t){var e=t[2].dName;if("on"===e){var n=t[2].dArgsAry[0],i=t[3].vExp,o=i.replace(/\(.*\)/,""),a=new Function("comp","with(comp){return "+o+"}");t[1]=i.replace(/this\./gim,'impex._cs["'+r.$id+'"].'),a=a.call(r,r),r[o]&&(a=a.bind(r)),a&&s.on(n,a)}}),s._slots=i,s._slotMap=o,s._innerHTML=t.raw.getInnerHTML(),s}function G(t,e,n){return $e={},st(t,e)?tt(t,e,n):(rt(t,e,e.parent?e.parent.children:null,e.parent,n),ot(e)),$e}function K(t,e){var n=Ee._cs[e._cid];if(!n)return!1;var r=t.raw.attributes,i=n.$vnode.raw.attributes;if(Object.keys(r).length!==Object.keys(i).length)return!1;for(var a in r)if(o(i[a]))return!1;return t.raw.getInnerHTML()==n._innerHTML}function tt(t,e,n){if(t._comp)return $e[e._cid]=t._forScopeQ,void(e._comp_directives=t.directives);if(t.tag){e._forScopeQ=t._forScopeQ;var r=Object.assign({},e.attributes);e.raw.attributes=t.raw.attributes,e.attributes={};for(var i in e.raw.attributes)e.attributes[i]=e.raw.attributes[i];for(var o=t.directives,a=e.directives,s=et(o),c=et(a),u=[],l=[],f=[],h=a.length;h--;){var p=a[h],d=p[0]+p[3];s[d]||l.push(p)}for(var h=o.length;h--;){var v=o[h],m=v[0]+v[3];c[m]?(c[m][2]=v[2],f.push(v)):u.push(v)}for(var h=l.length;h--;){var g=e.directives.indexOf(l[h]);e.directives.splice(g,1);var b=pt(l[h],n),_=b[0];_.onDestroy&&_.onDestroy(e,b[1])}f.forEach(function(t){var r=pt(t,n),i=r[0];i.onUpdate&&i.onUpdate(e,r[1],e.dom)}),u.forEach(function(t){e.directives.push(t);var r=pt(t,n),i=r[0];i.onBind&&i.onBind(e,r[1])}),e._comp_directives&&e._comp_directives.forEach(function(t){var r=pt(t,n),i=r[0];i.onBind&&i.onBind(e,r[1])}),ut(n,e.attributes,r,e.dom,e.tag)}else t.txt!==e.txt&&ct(t,e);t.children&&e.children?nt(t.children,e.children,e,n):t.children?at(e,t.children,n):e.children&&e.children.length>0&&ot(e.children)}function et(t){for(var e={},n=t.length;n--;){var r=t[n],i=r[0]+r[3];e[i]=r}return e}function nt(t,e,n,r){if(t.length<1)return void(e.length>0&&ot(e));for(var i=0,o=e.length-1,a=0,s=t.length-1,c=e[0],u=e[o],l=t[0],f=t[s];o>=i&&s>=a;)st(l,c)?(tt(l,c,r),c=e[++i],l=t[++a]):st(f,u)?(tt(f,u,r),u=e[--o],f=t[--s]):st(f,c)?(rt(c,it(u),e,n,r),c=e[i],o--,f=t[--s]):st(l,u)?(rt(u,c,e,n,r),u=e[o],i++,l=t[++a]):(rt(l,c,e,n,r),ot(c),c=e[++i],l=t[++a]);if(i==a&&o>s){var h=e.splice(i,o-s);h.length>0&&ot(h)}else if(o>=i&&o>0){var h=e.splice(i,o-i+1);h.length>0&&ot(h)}if(s>=a){var p=a==s?[t[a]]:t.splice(a,s-a+1);p.length>0&&rt(p,e[i],e,n,r)}}function rt(t,e,n,i,o){if(n){if(t.dom){var a=n.indexOf(t);a>-1&&n.splice(a,1)}var s=i;if(e)if(a=n.indexOf(e),s=s||e.parent,r(t)){for(var c=t.length;c--;)t[c].parent=s;var u=[a,0].concat(t);n.splice.apply(n,u)}else t.parent=s,n.splice(a,0,t);else r(t)?t.forEach(function(t){n.push(t),t.parent=s}):(t.parent=s,n.push(t))}var l=t.dom;if(l)l.parentNode.removeChild(l);else if(r(t)){for(var f=document.createDocumentFragment(),a=0;a<t.length;a++){var h=t[a],p=J(h,o);f.appendChild(p)}l=f}else l=J(t,o);if(e){var d=e.dom;d.parentNode.insertBefore(l,d)}else i.dom.appendChild(l)}function it(t){var e=t.parent,n=e.children.indexOf(t);return e.children[n+1]}function ot(t){r(t)||(t=[t]);for(var e=t[0].parent,n=t.length;n--;){var i=t[n],o=e.children.indexOf(i);o>-1&&e.children.splice(o,1);var a=i.dom.parentNode;a&&a.removeChild(i.dom),Ee._cs[i._cid]&&i.getAttribute(Nt)&&Ee._cs[i._cid].destroy()}}function at(t,e,n){t.children=e;for(var r=document.createDocumentFragment(),i=0;i<e.length;i++){var o=e[i],a=J(o,n);r.appendChild(a)}t.dom.appendChild(r)}function st(t,e){return t._comp?e.tag===t.tag?!0:e.tag&&e.getAttribute(Nt)==t.tag?K(t,e):!1:e.tag===t.tag}function ct(t,e){e.txt=t.txt;var n=e.dom;n.textContent=t.txt}function ut(t,e,n,r,i){for(var o=e,a=n,s=Object.keys(o),c=Object.keys(a),u="input"===i,l=s.length;l--;){var f=s[l],h=c.indexOf(f);0>h?(r.setAttribute(f,o[f]),u&&"value"===f&&(r.value=o[f])):(o[f]!=a[f]&&(r.setAttribute(f,o[f]),u&&"value"===f&&(r.value=o[f])),c.splice(h,1))}for(var l=c.length;l--;)c[l]!==Nt&&r.removeAttribute(c[l]);e[Ct]&&(t.$ref[e[Ct]]=r);var p=n[Nt];p&&(e[Nt]=p)}function lt(){this._eeMap={}}function ft(t){lt.call(this),this.$id="C_"+Ut++,this.$el=t,this.$ref={},this.$compTags={},this.$name,this.$parent,this.$children=[],this._watchers=[],this._combiningChange=!1,this._updateMap={},Ee._cs[this.$id]=this}function ht(){}function pt(t,e){var n=t[2].dName,r=Pt[n],i=t[2].dArgsAry,o=t[2].dFilter,a=t[1],s=t[3].vExp;return[r,{comp:e,value:a,args:i,exp:s,filter:o}]}function dt(t,e,n){if(o(t.txt)&&!t._comp){var r=t.directives;if(t._comp_directives&&(r=r.concat(t._comp_directives)),r&&r.length>0&&r.forEach(function(r){var i=pt(r,e),o=i[0];0==n?o.onActive&&o.onActive(t,i[1],t.dom):o.onUpdate&&o.onUpdate(t,i[1],t.dom)}),t.children&&t.children.length>0)for(var i=0;i<t.children.length;i++)dt(t.children[i],e,n)}}function vt(t,e){if(o(t.txt)&&!t._comp){var n=t.directives;if(t._comp_directives&&(n=n.concat(t._comp_directives)),n&&n.length>0&&n.forEach(function(n){var r=pt(n,e),i=r[0];i.onDestroy&&i.onDestroy(t,r[1])}),t.children&&t.children.length>0)for(var r=0;r<t.children.length;r++)vt(t.children[r],e)}}function mt(t,e){var n=null,r={},i={},o=null;if(e){n=e.template,r=e.state||{},o=e.input,i=e.computeState;for(var s=Object.keys(e),c=s.length;c--;){var u=s[c];a(e[u])&&(t[u]=e[u])}a(r)&&(r=r.call(t))}if(t._props){var l=gt(t,t.$parent,t._props,o);for(var u in l)r[u]=l[u]}n&&(t.onBeforeCompile&&t.vnode&&(n=t.onBeforeCompile(n,t.vnode.raw)),t._processedTmpl=n.trim().replace(/<!--[\s\S]*?-->/gm,"").replace(/<\s*script[\s\S]*?<\s*\/\s*script\s*>/gm,"").replace(/^\s+|\s+$/gim," ").replace(/>\s([^<]*)\s</,function(t,e){return">"+e+"<"})),N(r,t);for(var u in i){var f=i[u],h=f.get||f,p=new Q(function(t,e){var n=e.fn.call(this,this);this[e.k]=n},t);p.k=u,p.fn=h,H.target=p;var d=h.call(t);H.target=null,t.$state[u]=d,t.$state=U(t.$state,null,t,!0)}}function gt(t,e,n,r,i){var i={};if(r)for(var o in r){var a=r[o];a.require&&(i[o]=he)}var s={};if(n){var c={};for(var o in n){var u=n[o];if(o!=Ct)if(o=o.replace(/-[a-z0-9]/g,function(t){return t[1].toUpperCase()}),o[0]===Dt){var l=o.substr(1);c[l]=u}else s[o]=u}for(o in c){var f=t.$vnode,h=[e],p="",d="";if(f._forScopeQ)for(var v=0;v<f._forScopeQ.length;v++)p+="with(arguments["+(1+v)+"]){",d+="}",h.push(f._forScopeQ[v]);var m=new Function("scope","with(scope){"+p+"return "+c[o]+d+"}"),g=new Q(function(t,n){this[n.k]=n.fn.apply(e,n.args)},t);g.k=o,g.fn=m,g.args=h,H.target=g,s[o]=m.apply(e,h),H.target=null}for(var o in s){var u=s[o];r&&o in r&&delete i[o]}}if(s)return t.onPropBind&&(s=t.onPropBind(s)),s}function bt(t){var e=new Q(function(t){this._updateMap[t.name]=t,this._combiningChange||_t(this)},t);H.target=e;var n=xt(t);H.target=null;var r=null;if(t.$vnode){r=t.$vnode.parent;var i=r.children,o=i.indexOf(t.$vnode);o>-1&&i.splice(o,1,n),n._comp_directives=t.$vnode.directives}t.$vnode=n,n.parent=r,t.onCompile&&t.onCompile(t.$vnode)}function _t(t){t._combiningChange=!0,t._updateTimer=setTimeout(function(){wt(t,t._updateMap),t._updateMap={},t._combiningChange=!1},20)}function yt(t,e){var n=J(t.$vnode,t);t.onBeforeMount&&t.onBeforeMount(n),t.$el.parentNode.replaceChild(n,t.$el),t.$el=n,t.$name&&(t.$el.setAttribute(Nt,t.$name),t.$vnode.setAttribute(Nt,t.$name)),t.onMount&&t.onMount(t.$el),dt(t.$vnode,t,0)}function wt(t,e){var n=!0;if(t.onBeforeUpdate&&(n=t.onBeforeUpdate(e)),n!==!1){for(var r=xt(t),i=(G(r,t.$vnode,t),0);i<t.$children.length;i++){var a=t.$children[i];o(a._processedTmpl)&&a._parse()}t.onUpdate&&t.onUpdate(e),t.$children.forEach(function(t){var e=t.$vnode;e._comp_directives&&e._comp_directives.forEach(function(n){var r=pt(n,t),i=r[0];i.onUpdate&&i.onUpdate(e,r[1],e.dom)})})}}function xt(t){var e=null,n=p(t._processedTmpl,t);return e=n.call(t,t,I,q,V,Y,Z)}function $t(t,e,n){var r=(t.target||t.srcElement).value,i=e.getAttribute("number");o(i)||(r=parseFloat(r));var a=e.getAttribute("debounce");if(a){e.debounceTimer&&(clearTimeout(e.debounceTimer),e.debounceTimer=null);var s=this;e.debounceTimer=setTimeout(function(){clearTimeout(e.debounceTimer),e.debounceTimer=null,At(e,r,s||n)},a)}else At(e,r,this||n)}function Et(t,e,n){var i=t.target||t.srcElement,o=i.value,a="with(scope){return "+e._exp+"}",s=new Function("scope",a),c=null;if(c=s(this?this:n),c=r(c)?c.concat():[c],i.checked)c.push(o);else{var u=c.indexOf(o);u>-1&&c.splice(u,1)}At(e,c,n)}function At(t,e,n){var r=new Function("comp","v","comp."+t._exp+"= v;");r(n,e)}var Ot="x-",Tt=":",kt=".",Lt="{{",Mt="}}",St=/^x-.*/,Ct="ref",Bt="id",Dt=".",jt="@",Qt=".",Ht=new RegExp(Lt+"(.+?)(?:(?:(?:=>)|(?:=&gt;))(.+?))?"+Mt,"img"),Nt="impex-component",Ut=0,Ft={},Pt={},Rt={component:1},zt={},It=["br","hr","img","input","link","meta","area","base","col","embed","keygen","param","source","track","wbr"],qt=new RegExp("<([-a-z0-9]+)((?:\\s+[-a-zA-Z0-9_"+jt+Qt+Tt+"]+(?:\\s*=\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')))?)*)\\s*(?:/?)>","im"),Vt=new RegExp("[a-zA-Z_"+jt+Qt+"][-a-zA-Z0-9_"+jt+Qt+Tt+"]*(?:\\s*=\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>\\s]+))?","img"),Yt=/<\/([-a-z0-9]+)>/im,Zt=/<\/([-a-z0-9]+)>/gim,Jt="slot",Wt=[],Xt=0,Gt={},Kt=[],te=self.navigator.userAgent.toLowerCase(),ee=te.indexOf("android")>0?!0:!1,ne=te.indexOf("iphone")>0?!0:!1,re=te.indexOf("ipad")>0?!0:!1,ie=te.indexOf("windows phone")>0?!0:!1,oe=ne||re||ee||ie;if(oe){var ae,se,ce=200,ue=0,le=!1,fe=!1;document.addEventListener("touchstart",x,!0),document.addEventListener("touchmove",$,!0),document.addEventListener("touchend",A,!0),document.addEventListener("touchcancel",E,!0)}else{document.addEventListener("click",O,!0),document.addEventListener("dblclick",T,!0),document.addEventListener("mousedown",k,!0),document.addEventListener("mousemove",L,!0),document.addEventListener("mouseup",M,!0),window.addEventListener("blur",S,!0);var he=null==self.onmousewheel?"mousewheel":"DOMMouseScroll";document.addEventListener(he,D,!0),document.addEventListener("mouseout",C,!0),document.addEventListener("mouseover",B,!0);var ae}document.addEventListener("input",function(t){y("input",t)},!0),document.addEventListener("change",function(t){y("change",t)},!0),document.addEventListener("keydown",function(t){y("keydown",t)},!0),document.addEventListener("keypress",function(t){y("keypress",t)},!0),document.addEventListener("keyup",function(t){y("keyup",t)},!0),document.addEventListener("focus",function(t){y("focus",t)},!0),document.addEventListener("blur",function(t){y("blur",t)},!0);var pe=null==self.onwheel?"wheel":"mousewheel";document.addEventListener(pe,function(t){y("wheel",t)},!0),document.addEventListener("scroll",function(t){y("scroll",t)},!0),Q.prototype={update:function(t){this.handler&&this.handler.call(this.component,t,this)},dispose:function(){this.monitors.forEach(function(t){t.removeWatcher(this)},this),this.component=this.handler=this.monitors=this.key=null},depend:function(t){this.monitors.indexOf(t)<0&&this.monitors.push(t)}},H.prototype={notify:function(t,e){this.value=t;var n=new j(this.key,t,this.value,e,this.target);this.watchers.forEach(function(t){t.key=this.key,t.update(n)},this)},collect:function(){H.target&&(H.target.depend(this),this.watchers.indexOf(H.target)<0&&this.watchers.push(H.target))},removeWatcher:function(t){var e=this.watchers.indexOf(t);e>-1&&this.watchers.splice(e,1)}};var de=Array.prototype.push,ve=Array.prototype.pop,me=Array.prototype.shift,ge=Array.prototype.unshift,be=Array.prototype.splice,_e=Array.prototype.reverse,ye=Array.prototype.sort,we=0,xe=0;R.prototype={getInnerHTML:function(){var t=new RegExp("<s*/s*"+this.tag+"s*>","img"),e=this.innerHTML.trim(),n=t.exec(e);return n?e.substring(0,n.index):e},getOuterHTML:function(){return this.outerHTML+this.getInnerHTML()+"</"+this.tag+">"}},z.prototype={on:function(t,e,n){var r=zt[t];r||(r=zt[t]={});var i=!1;if(a(e)&&(i=!0),i)r[this.vid]=[this,n,e,this._cid,i];else{var o=this.getAttribute("var");if(o){var s=o.replace(/^{|}$/gm,"").split(","),c="";s.forEach(function(t){var e=t.split(":");c+="var "+e[0]+"="+e[1]+";"}),o=c}var u="",l="";if(this._forScopeQ)for(var f=0;f<this._forScopeQ.length;f++)u+="with(arguments["+(3+f)+"]){",l+="}";r[this.vid]=[this,n,new Function("comp,$event,$vnode","with(comp){"+u+o+";"+e+l+"}"),this._cid]}this._hasEvent=!0},off:function(t){var e=zt[t];if(e)e[this.vid]=null;else if(!t)for(var n in zt)e=zt[n],e&&(e[this.vid]=null)},setAttribute:function(t,e){return this.attributes[t]=e,this},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){this.attributes[t]=null,delete this.attributes[t]}};var $e=null;lt.prototype={on:function(t,e,n){return this._eeMap[t]=[e,n||this],this},off:function(t){this._eeMap[t]=null},emit:function(t){var e=this._eeMap[t];if(e){var n=e[0],r=e[1];if(n){for(var i=[],o=1;o<arguments.length;o++)i.push(arguments[o]);return n.apply(r,i)}}},getEvent:function(t){return this._eeMap[t]}},ht.prototype=lt.prototype,ft.prototype=new ht,ft.prototype.constructor=ft.constructor,e({$watch:function(t,e){var n=new Q(function(t){e&&e.call(this,t.newVal,t.oldVal,t.name)},this);H.target=n;var r=new Function("state","return state."+t);return r(this.$state),H.target=null,this},destroy:function(){this.onDestroy&&this.onDestroy();var t=this.$id;if(this._watchers.forEach(function(t){t.dispose()}),this._watchers=null,this._updateTimer&&(clearTimeout(this._updateTimer),this._updateTimer=null),this.$parent){var e=this.$parent.$children.indexOf(this);e>-1&&this.$parent.$children.splice(e,1),this.$parent=null}for(;this.$children.length>0;)this.$children[0].destroy();this.$children=Ee._cs[t]=null,delete Ee._cs[t],vt(this.$vnode,this),this.$vnode=this.$el=this.$compTags=this.$root=this.$ref=this.$id=null},onPropChange:function(t,e,n){this[t]=e},$mount:function(t){t&&(i(t)&&t.trim()&&(t=document.querySelector(t)),t.append(this.$el)),yt(this,this.$vnode)},_parse:function(t){t=t||Rt[this.$name],mt(this,t),this.onCreate&&this.onCreate(),this._processedTmpl&&bt(this),this.$el&&this.$mount();for(var e=this.$children.length;e--;)this.$children[e]._parse()}},ft.prototype);var Ee=new function(){this.id={},this.version={v:[0,99,1],state:"alpha",toString:function(){return Ee.version.v.join(".")+" "+Ee.version.state}},this.website="http://impexjs.org",this.config=function(t){var e=t.delimiters||[];Lt=e[0]||"{{",Mt=e[1]||"}}",Ht=new RegExp(Lt+"(.+?)(?:(?:(?:=>)|(?:=&gt;))(.+?))?"+Mt,"img")},this.component=function(t,e){return Rt[t]=e,this},this.hasComponentOf=function(t){return!!Rt[t]},this.directive=function(t,e){return Pt[t]=e,this},this.filter=function(t,e){return Ft[t]=e,this},this.create=function(t){var e=null,n=t.el;if(n instanceof HTMLElement)e=n.outerHTML;else if(i(n)&&n.trim())try{n=document.querySelector(n),e=n.outerHTML}catch(r){e=n}var o=new ft(i(n)?null:n);return o.$name="ROOT",o.$root=o,t.template=e,o._parse(t),o},Object.defineProperty(this,"_cs",{enumerable:!1,writable:!0,value:{}}),this.Component=ft,this.EventEmitter=lt};Ee.directive("style",{onBind:function(t,e){var n=e.value;if(i(n)){for(var r={},o=n.split(";"),a=o.length;a--;)if(o[a]){var s=o[a].split(":");r[s[0]]=s[1]}n=r}var c=t.getAttribute("style")||"";for(var u in n){var l=this.filterName(u),f=n[u];l=l.replace(/[A-Z]/gm,function(t){return"-"+t.toLowerCase()}),c+=l+":"+f+";"}t.setAttribute("style",c)},onUpdate:function(t,e){t.setAttribute("style",t.raw.attributes.style),this.onBind(t,e)},onDestroy:function(t){o(t.raw.attributes.style)?t.removeAttribute("style"):t.setAttribute("style",t.raw.attributes.style)},filterName:function(t){return t.replace(/-([a-z])/gim,function(t,e){return e.toUpperCase()})}}).directive("class",{onBind:function(t,e){var n=e.value,o=t.getAttribute("class")||"",a=o.trim().replace(/\s+/gm," ").split(" "),s=null;if(i(n))s=n.split(" ");else if(r(n))s=n;else{s=[];for(var c in n){var u=n[c];u&&s.push(c)}}s.forEach(function(t){t&&a.indexOf(t.trim())<0&&a.push(t)}),t.setAttribute("class",a.join(" "))},onUpdate:function(t,e){t.setAttribute("class",t.raw.attributes["class"]),this.onBind(t,e)},onDestroy:function(t,e){o(t.raw.attributes["class"])?t.removeAttribute("class"):t.setAttribute("class",t.raw.attributes["class"])}}).directive("on",{onBind:function(t,e){for(var n=e.args,r=n.length;r--;)t.on(n[r],e.value,e.filter)},onDestroy:function(t,e){for(var n=e.args,r=n.length;r--;)t.off(n[r])}}).directive("bind",{onBind:function(t,e){for(var n=e.args,r=n.length;r--;){var i=n[r];switch(i){case"style":Pt[i].onUpdate(t,e);break;case"class":Pt[i].onUpdate(t,e);break;default:t.setAttribute(i,e.value)}}},onUpdate:function(t,e){this.onBind(t,e)},onDestroy:function(t,e){for(var n=e.args,r=n.length;r--;){var i=n[r];switch(i){case"style":Pt[i].onDestroy(t,e);break;case"class":Pt[i].onDestroy(t,e);break;default:t.removeAttribute(i)}}}}).directive("show",{onBind:function(t,e){var n=t.getAttribute("style")||"";return n=e.value?n.replace(/;display\s*:\s*none\s*;?/,""):n.replace(/;display:none;/,"")+";display:none;",t.setAttribute("style",n),n},onUpdate:function(t,e,n){var r=this.onBind(t,e);n.setAttribute("style",r)},onDestroy:function(t){var e=t.getAttribute("style");e&&(e=e.replace(/;display\s*:\s*none\s*;?/,""),t.setAttribute("style",e))}}).directive("cloak",{}).directive("model",{onBind:function(t,e){switch(t._exp=e.exp,t.tag){case"select":t.on("change",this.handleChange);break;case"input":var n=t.attributes.type;if("radio"==n||"checkbox"==n){t.on("change",this.handleChange);break}default:t.on("input",$t)}},handleChange:function(t,e){{var n=t.target,r=n.tagName.toLowerCase();n.value}switch(r){case"textarea":case"input":var i=n.getAttribute("type");switch(i){case"radio":$t(t,e,this);break;case"checkbox":Et(t,e,this)}break;case"select":var o=n.getAttribute("multiple");if(null!==o){for(var a=[],s=n.options.length;s--;){var c=n.options[s];c.selected&&a.push(c.value)}At(e,a,this)}else $t(t,e,this)}}}),Ee.filter("json",function(t){return JSON.stringify(t)}).filter("filterBy",function(t,e,n){var i=t;if(!r(i))return t;var o=[];if(a(e))for(var s=i.length;s--;){var c=e.call(this,i[s]);c&&o.unshift(i[s])}else for(var s=i.length;s--;){var u=i[s];n?(!e||(u[n]+"").indexOf(e)>-1)&&o.unshift(u):(!e||u.indexOf&&u.indexOf(e)>-1)&&o.unshift(u)}return o}).filter("limitBy",function(t,e,n){return r(t)?(t=t.concat(),e?t.splice(n||0,e):t):t}).filter("orderBy",function(t,e,n){return(e||n)&&r(t)?(t=t.concat(),t.sort(function(t,n){var r=e?t[e]:t,i=e?n[e]:n;return"string"==typeof r?r.localeCompare(i):"number"==typeof r?r-i:(r+"").localeCompare(i)}),"desc"===n&&t.reverse(),t):t}),"object"==typeof module&&"object"==typeof module.exports?module.exports=Ee:t.impex=Ee}(window||this);