/*
 * impexjs is a powerful web application engine to build 
 * reactive webUI system
 *
 *
 * Copyright 2015-2018 MrSoya and other contributors
 * Released under the MIT license
 *
 * website: http://impexjs.org
 * last build: 2018-7-31
 */
!function(e){"use strict";function t(e,t){for(var n=Object.keys(e),r=n.length;r--;){var i=n[r];t[i]=e[i]}}function n(e){return"object"==typeof e&&null!==e}function r(e){return e instanceof Array}function i(e){return"string"==typeof e}function a(e){return void 0===e}function o(e){return e instanceof Function}function s(){if(0===this.status||this.status>=200&&this.status<300||304===this.status){{var e=this.responseText,t=Oe[this.url],n=t.cbks;t.name}e.match(/<\s*template[^<>]*>([\s\S]*)<\s*\/\s*template\s*>/gim)[0];var r=RegExp.$1,i="";r=r.replace(/<\s*style[^<>]*>([\s\S]*?)<\s*\/\s*style\s*>/gim,function(e,t){return i+=t,""}),e.match(/<\s*script[^<>]*>([\s\S]*?)<\s*\/\s*script\s*>/gim)[0];var a=RegExp.$1,o=new Function("return ("+a+")")();o=o(),o.template=r.trim();{this.url}n.forEach(function(e){e(o,i.trim())}),Oe[this.url]=null}}function c(e,t,n,r){if(Oe[t])return void Oe[t].cbks.push(n);Oe[t]={name:e,cbks:[]},Oe[t].cbks.push(n);var i=new XMLHttpRequest;i.open("get",t,!0),null===i.onload?i.onload=s:i.onreadystatechange=s,i.url=t,i.send(null)}function u(e,t,n){this.type=e,this.tag=t,this.txtQ=n,this.children=[],this.attrNodes={},this.slotMap={}}function l(e,t){this.value,this.name=e,this.directive=t}function f(e,t,n){this.tag=e,this.txt,this.children,this.vid=Ne++,this.attrNodes=t,this._directives=n,this._comp,this.dom,this._forScopeQ,this._slotMap,this._hasEvent}function h(e,t,n,r,i,a,o){var s=new f(t,n,r);if(s._isEl=!0,o.length>0&&(s._forScopeQ=o),mt[t]||"component"==t){s._comp=!0;var c=i[0];return c&&(s._slots=c[0],s._slotMap=c[1]),s}if(null!=a){{var u,l,m="",g="",b=[e,e.state,h,p,d,v,_],y=[];b.length}if(s._forScopeQ)for(var w=0;w<s._forScopeQ.length;w++){var x="forScope"+Pe++;m+="with("+x+"){",g+="}",b.push(s._forScopeQ[w]),y.push(x)}l=k("<"+t+">"+a+"</"+t+">",e,y);var S=y.length>0?","+y.toString():"",O=new Function("comp,state,_ce,_tmp,_ct,_li,_fi"+S,"with(comp){with(state){"+m+"return "+l+";"+g+"}}");u=O.apply(e,b),i=u.children||[]}return i.length>0&&(s.children=[],i.forEach(function(e){e&&(e instanceof Array?e.forEach(function(e){e.parent=s,s.children.push(e)}):(e.parent=s,s.children.push(e)))})),s}function p(e,t){var n=null;t&&(n=[t]);var r=[];return e.length>0&&e.forEach(function(e){if(e)if(e instanceof Array)e.forEach(function(e){if(r.push(e),n){var t=e._forScopeQ;e._forScopeQ=t?n.concat(t):n}});else if(r.push(e),n){var t=e._forScopeQ;e._forScopeQ=t?n.concat(t):n}}),r}function d(e){var t=new f;return t.txt=e&&e.toString?e.toString():e,t}function v(e,t,n,i,a){var o=[];return e.forEach(function(e,s){var c={$index:s};i&&(c[i]=s),c[a]=e;var u=t.call(n,c);u&&(r(u)?o=o.concat(u):o.push(u))}),o}function _(e,t,n){for(var r=0;r<t.length;r++){var i=t[r],a=dt[i[0]],o=i[1];o.unshift(e),e=a.apply(a,o)}return e}function m(e,t,n){var r=null,i=null,a=null;if(it.test(e)){var o=e.replace(We,""),s=o.indexOf(et);s>-1&&(o=o.substring(0,s)),r=o;var c=e.indexOf(et);switch(c>-1&&(i=e.substr(c+1)),o){case"if":case"else":case"for":case"html":return o}}else e[0]===ct?(r="on",i=e.substr(1)):e[0]!==ut||n||(r="bind",i=e.substr(1));if(i){var u=i.indexOf(tt);u>-1&&(a=i.substr(u+1),i=i.substring(0,u)),i=i.split(et)}return r?[r,i,a]:r}function g(e,t,n){if("for"!==e)return!1;var r=null,i=(t.exp[0],t.exp[1]),a=RegExp.$2,o=a.split(","),s=o.length>1?o[0]:null,c=o.length>1?o[1]:o[0],u=RegExp.$1;return r=u.match(/^([\s\S]*?)\s+to\s+([\s\S]*?)$/)?[s,c,i,RegExp.$1,RegExp.$2]:[s,c,i,u]}function b(e,t){return"if"!==e?!1:t.exp[0]}function y(e,t){return"html"!==e?!1:t.exp[0]}function w(e){for(var t,n,r=null,i=[],a=[],o=[],s=[];e.length>0;){if(!r){r=Ae.exec(e);var c=r.index+r[0].length;e=e.substr(c)}var l=r[1],f=new u(1,l),h=i[i.length-1];h?h.children.push(f):o.push(f),mt[l]&&(n=f,a.push(f));var p=r[2].trim(),d=p.match(ke);if(d&&x(d,f,n),e.length<1)break;l===ht?s.push([h,f,f.attrNodes.name?f.attrNodes.name.value:null]):f.attrNodes.slot&&n&&(n.slotMap[f.attrNodes.slot.value]=f),Fe.indexOf(l)<0&&i.push(f);var v=Ae.exec(e);v&&(r=v),t=Me.exec(e);var _=t?t.index:-1,m=v?v.index:-1;if(h=i[i.length-1],m>-1&&_>m)S(e.substr(0,m),h),e=e.substr(m+v[0].length);else{S(e.substr(0,_),h);var g=_+t[0].length;Te.lastIndex=0,Te.exec(e);do{var b=i.pop();if(b===n&&(a.pop(),n=a[a.length-1]),i.length<1)break;t=Te.exec(e),_=t.index;var y=e.substring(g,t.index);if(y.trim()){if(_>m){var b=Ae.exec(y);b&&(y=y.substr(0,b.index).trim())}y.trim()&&(f=i[i.length-1],S(y,f))}g=_+t[0].length}while(m>_);if(!v)break;e=e.substr(m+v[0].length)}}return[o,s]}function x(e,t,n){for(var r=e.length;r--;){var i,a=e[r],o=a.indexOf("="),s=null;0>o?i=a:(i=a.substring(0,o),s=a.substring(o+2,a.length-1));var c=new l(i,m(i,t,n&&t==n));if(t.attrNodes[i]=c,c.value=s,c.directive){if(s){s=s.replace(/&amp;/gm,"&");var u,f,o=s.indexOf("=>");0>o?u=s:(u=s.substring(0,o),f=s.substring(o+2,s.length)),c.exp=O(u,f)}var h=null,p=c.directive;("for"===p||"if"===p||"else"===p||"html"===p)&&((h=g(p,c,n))&&(t["for"]=h),(h=b(p,c))&&(t["if"]=h),(h=y(p,c))&&(t.html=h),"else"===p&&(t["else"]=!0),t.attrNodes[c.name]=null,delete t.attrNodes[c.name])}}}function S(e,t){e=e.trim();var n=[];if(e){for(var r=null,i=0;r=lt.exec(e);){var a=e.substring(i,r.index);a&&n.push(a),n.push(O(r[1],r[2],!0)),i=r.index+r[0].length}i<e.length&&n.push(e.substr(i)),n.length<1&&n.push(e);var o=new u(3,null,n);t.children.push(o)}}function O(e,t,n){var r=[];r[0]=e.trim(),n&&(r[0]="("+r[0]+")");var i=[];if(t)for(var a=t.split("|"),o=0;o<a.length;o++){var s=a[o].split(":");i.push({name:s[0].trim(),param:s.slice(1)})}return r[1]=i,r}function E(e,t,n){var r="";if(1===e.type){var i,a;e["for"]&&(i="forScope"+Pe++,n=n.concat(i)),a="["+n.toString()+"]";var o="";if(mt[e.tag])o=JSON.stringify([e.children,e.slotMap]);else{for(var s=0;s<e.children.length;s++){var c=e.children[s-1];o+=","+E(e.children[s],c?c["if"]:null,n)}o.length>0&&(o=o.substr(1))}var u=N(e.attrNodes),l=u[0],f=u[1],h=e["if"]||"true";h="("+h+")",t&&e["else"]&&(h="!("+t+")");var p=e.html||"null",d=h+'?_ce(this,"'+e.tag+'",'+l+","+f+",["+o+"],"+p;if("template"==e.tag&&(d=h+"?_tmp(["+o+"]"),e["for"]){var v=(e["for"][0]||"").trim(),_=e["for"][1].trim(),m=e["for"][2],g=e["for"][3],b=e["for"][4],y=g,w="";if(e.attrNodes["var"]){w=e.attrNodes["var"].value;var x=w.replace(/^{|}$/gm,"").split(","),S="";x.forEach(function(e){var t=e.split(":");S+="var "+t[0]+"="+t[1]+";"}),w=S}b&&(y="(function(){var rs=[];for(var i="+g+";i<="+b+";i++)rs.push(i);return rs;}).call(this)"),m&&(y="_fi("+y+","+F(m)+",comp)"),r+="_li("+y+",function("+i+"){with("+i+"){"+w+" return "+d+","+a+'):null}},this,"'+v+'","'+_+'")'}else r+=d+","+a+"):null"}else{var O=C(e.txtQ);r+="_ct("+O+")"}return r}function N(e){var t={},n="";for(var r in e){var i=e[r];if(i.directive){var a=i.value,o="on"===i.directive[0]||"model"===i.directive[0]?JSON.stringify(a):a;n+=",['"+r+"',"+JSON.stringify(i.directive)+","+o+","+JSON.stringify(a)+"]"}else t[r]=i.value}return[JSON.stringify(t),"["+n.substr(1)+"]"]}function C(e){var t="";return e.forEach(function(e){if(e instanceof Array){var n=e[0],r=e[1];t+=r.length>0?"+_fi("+n+","+F(r)+",comp)":"+"+n}else e&&(t+="+"+JSON.stringify(e))}),t=t.replace(/\n/gm,""),t.length>0&&(t=t.substr(1)),t}function F(e){var t="";return e.forEach(function(e){var n='["'+e.name+'",['+e.param.toString()+"]]";t+=","+n}),"["+t.substr(1)+"]"}function A(e,t){if(Ce[e]&&!t.__slots&&!t.__slotMap)return Ce[e];var n="with(comp){with(state){return "+k(e,t,[])+"}}";return n=new Function("comp,state,_ce,_tmp,_ct,_li,_fi",n),Ce[e]=n,n}function k(e,t,n){var r=w(e),i=r[0],a=i[0];he(r[1],t.__slots,t.__slotMap);var e=E(a,null,n);return e}function M(e){var t=null,n=A(e.compiledTmp,e);return t=n.call(e,e,e.state,h,p,d,v,_)}function T(e,t,n){return je={},$(e,t)?P(e,t,n):(L(e,t,t.parent?t.parent.children:null,t.parent,n),Q(t)),je}function P(e,t,n){if(e._comp)return void(je[t._cid]=e._forScopeQ);if(e.tag){t._forScopeQ=e._forScopeQ;for(var r=t.attrNodes,i=e._directives,a=t._directives,o=j(i),s=j(a),c=[],u=[],l=a.length;l--;){var f=a[l],h=f[0]+f[3];o[h]||u.push(f)}for(var l=i.length;l--;){var p=i[l],d=p[0]+p[3];s[d]?s[d][2]=p[2]:c.push(p)}t.attrNodes=e.attrNodes;for(var l=u.length;l--;){var v=t._directives.indexOf(u[l]);t._directives.splice(v,1);var _=u[l][1][1],m=u[l][2],g=u[l][3];u[l].onDestroy&&u[l].onDestroy(t,{value:m,args:_,exp:g})}for(var l=c.length;l--;)t._directives.push(c[l]);t.off(),t._directives.forEach(function(e){var n=e[1][0],r=vt[n];if(r){var i=e[1][1],a=e[2],o=e[3];r.onBind&&r.onBind(t,{value:a,args:i,exp:o})}}),q(t.attrNodes,r,t.dom,t.tag)}else e.txt!==t.txt&&R(e,t);e.children&&t.children?B(e.children,t.children,t,n):e.children?D(t,e.children,n):t.children&&t.children.length>0&&Q(t.children)}function j(e){for(var t={},n=e.length;n--;){var r=e[n],i=r[0]+r[3];t[i]=r}return t}function B(e,t,n,r){if(e.length<1)return void(t.length>0&&Q(t));for(var i=0,a=t.length-1,o=0,s=e.length-1,c=t[0],u=t[a],l=e[0],f=e[s];a>=i&&s>=o;)$(l,c)?(P(l,c,r),c=t[++i],l=e[++o]):$(f,u)?(P(f,u,r),u=t[--a],f=e[--s]):$(f,c)?(L(c,V(u),t,n,r),c=t[i],a--,f=e[--s]):$(l,u)?(L(u,c,t,n,r),u=t[a],i++,l=e[++o]):(L(l,c,t,n,r),Q(c),c=t[++i],l=e[++o]);if(a>=i&&a>0){var h=t.splice(i,a-i+1);h.length>0&&Q(h)}if(s>=o){var p=o==s?[e[o]]:e.splice(o,s-o+1);p.length>0&&L(p,t[i],t,n,r)}}function L(e,t,n,i,a){if(n){if(e.dom){var o=n.indexOf(e);o>-1&&n.splice(o,1)}var s=i;if(t)if(o=n.indexOf(t),s=s||t.parent,r(e)){for(var c=e.length;c--;)e[c].parent=s;var u=[o,0].concat(e);n.splice.apply(n,u)}else e.parent=s,n.splice(o,0,e);else r(e)?e.forEach(function(e){n.push(e),e.parent=s}):(e.parent=s,n.push(e))}var l=e.dom;if(l)l.parentNode.removeChild(l);else if(r(e)){for(var f=document.createDocumentFragment(),o=0;o<e.length;o++){var h=e[o],p=oe(h,a);f.appendChild(p)}l=f}else l=oe(e,a);if(t){var d=t.dom;d.parentNode.insertBefore(l,d)}else i.dom.appendChild(l)}function V(e){var t=e.parent,n=t.children.indexOf(e);return t.children[n+1]}function Q(e){r(e)||(e=[e]);for(var t=e[0].parent,n=e.length;n--;){var i=e[n],a=t.children.indexOf(i);a>-1&&t.children.splice(a,1);var o=i.dom.parentNode;o&&o.removeChild(i.dom),yt._cs[i._cid]&&i.getAttribute(ft)&&yt._cs[i._cid].destroy()}}function D(e,t,n){e.children=t;for(var r=document.createDocumentFragment(),i=[],a=0;a<t.length;a++){var o=t[a],s=oe(o,n);o._comp&&(le(o._comp),i.push(o._comp)),r.appendChild(s)}e.dom.appendChild(r);for(var a=0;a<i.length;a++){var c=i[a];ve(c,e)}}function $(e,t){return e._comp?t.getAttribute(ft)==e.tag?!0:!1:t.tag===e.tag}function R(e,t){t.txt=e.txt;var n=t.dom;n.textContent=e.txt}function q(e,t,n,r){for(var i=e,a=t,o=Object.keys(i),s=Object.keys(a),c="input"===r,u=o.length;u--;){var l=o[u],f=s.indexOf(l);0>f?(n.setAttribute(l,i[l]),c&&"value"===l&&(n.value=i[l])):(i[l]!=a[l]&&(n.setAttribute(l,i[l]),c&&"value"===l&&(n.value=i[l])),s.splice(f,1))}for(var u=s.length;u--;)s[u]!==ft&&n.removeAttribute(s[u]);var h=t[ft];h&&(e[ft]=h)}function z(e,t){var n=t.target,r=!1;do{var i=n._vid;if(void 0!==i){var a=gt[e];if(a){var o=a[i];if(o){var s=o[0];if("mouseleave"==e){var c=t.target;if(!J(s.dom,c))return;var u=t.toElement||t.relatedTarget;if(J(s.dom,u))return}var l=o[1],f=o[2],h=o[3],p=yt._cs[f];if(h)l.call(p,t,s);else{var d=[p,p.state,t,s];if(s._forScopeQ)for(var v=0;v<s._forScopeQ.length;v++)d.push(s._forScopeQ[v]);l.apply(p,d)}r=t.cancelBubble}}}}while((n=n.parentNode)&&"BODY"!=n.tagName&&!r)}function J(e,t){if(e.contains)return e.contains(t);do{if(e==t)return!0;t=t.parentNode}while(t&&"BODY"!=t.tagName);return!1}function U(e){z("touchstart",e),z("pointerdown",e),Re=setTimeout(function(){z("press",e)},800),Ue=!1,Ze=!1;var t=e.touches[0];qe={x:t.clientX,y:t.clientY,t:Date.now()}}function Z(e){clearTimeout(Re),z("touchmove",e),z("pointermove",e),Ue=!0}function H(e){clearTimeout(Re),Ze=!0,z("touchcancel",e),z("pointercancel",e)}function Y(e){if(clearTimeout(Re),z("touchend",e),z("pointerup",e),!Ze)if(Ue){var t=e.changedTouches[0],n=t.clientX,r=t.clientY,i=qe,a=i.x,o=i.y,s=i.t,c=Date.now()-s,u=Math.sqrt((n-a)*(n-a)+(r-o)*(r-o))>>0;if(ze>=c&&u>20){var l=Math.atan2(r-o,n-a),f={slope:l,interval:c,distance:u};z("fling",e,f)}}else z("tap",e),Date.now()-Je<300&&z("dbltap",e),Je=Date.now()}function X(e){z("mousedown",e),z("pointerdown",e),Re=setTimeout(function(){z("press",e)},800)}function I(e){clearTimeout(Re),z("mousemove",e),z("pointermove",e)}function G(e){clearTimeout(Re),z("mouseup",e),z("pointerup",e),0===e.button&&(z("click",e),z("tap",e),Date.now()-Ye<300&&(z("dblclick",e),z("dbltap",e)),Ye=Date.now())}function K(e){clearTimeout(Re),z("pointercancel",e)}function W(e){z("mouseout",e),z("mouseleave",e)}function ee(e){z("mouseover",e)}function te(e){z("mousewheel",e)}function ne(e,t,n,r,i,a){this.name=e,this.newVal=t,this.oldVal=n,this.path=r,this.type=i,this.object=a}function re(){this.__eeMap={}}function ie(e){re.call(this),this._uid="C_"+pt++,this.el=e,this.refs={},this.compTags={},this.input=null,this.name,this.parent,this.children=[],this.__watchMap={},this.__watchFn,this.__watchOldVal,this.__watchPaths=[],this.__syncFn={},this.__syncOldVal={},this.__syncFnForScope={},this.__dependence={},this.state={},yt._cs[this._uid]=this}function ae(){}function oe(e,t){var n,r=t._uid;if(e._isEl){if(n=document.createElement(e.tag),n._vid=e.vid,e._cid=r,!e._comp){var i=e._directives;i&&i.length>0&&i.forEach(function(n){var r=n[1][0],i=vt[r];if(i){var a=n[1][1],o=n[2],s=n[3];i.onBind&&i.onBind(e,{comp:t,value:o,args:a,exp:s})}})}for(var a in e.attrNodes)a[0]!==ut&&n.setAttribute(a,e.attrNodes[a]);if(e.attrNodes[at]&&(t.refs[e.attrNodes[at]]=n),e._comp){var o=ge(e,e.tag,n,t,e._slots,e._slotMap,e.attrNodes);e._comp=o}else if(e.children&&e.children.length>0)for(var s=0;s<e.children.length;s++){var o=oe(e.children[s],t);n.appendChild(o)}}else n=document.createTextNode(se(e.txt));return e.dom=n,n}function se(e){return e&&e.replace?e.replace(/&lt;/gim,"<").replace(/&gt;/gim,">").replace(/&nbsp;/gim," ").replace(/&amp;/gim,"&"):e}function ce(e,t,n){if(a(e.txt)&&!e._comp){var r=e._directives;if(r&&r.length>0&&r.forEach(function(r){var i=r[1][0],a=vt[i];if(a){var o=r[1][1],s=r[2],c=r[3];0==n?(_t[i+"."+c]=s,a.onActive&&a.onActive(e,{comp:t,value:s,args:o,exp:c},e.dom)):_t[i+"."+c]!=s&&(a.onUpdate&&a.onUpdate(e,{comp:t,value:s,args:o,exp:c},e.dom),_t[i+"."+c]=s)}}),e.children&&e.children.length>0)for(var i=0;i<e.children.length;i++)ce(e.children[i],t,n)}}function ue(e,t){if(t){var n=pe(e,t);if(!bt[e]){if(n.trim().length>0){var r=document.head.children[0];r?r.insertAdjacentHTML("afterend","<style>"+n+"</style>"):document.head.innerHTML="<style>"+n+"</style>"}bt[e]=!0}}}function le(e){e.__url?c(e.name,e.__url,function(n,r){mt[e.name]=n,t(n,e),o(n.state)?e.state=n.state.call(e):n.state&&(e.state={},t(n.state,e.state)),fe(e.template,e),e.onCreate&&e.onCreate(),be(e,e.parent,e.__attrs),ue(e.name,r),e.__attrs=e.__url=null,de(e),ve(e,e.parent?e.parent.vnode:null)}):(e.template&&fe(e.template,e),de(e))}function fe(e,t){t.onBeforeCompile&&(e=t.onBeforeCompile(e)),t.compiledTmp=e.trim().replace(/<!--[\s\S]*?-->/gm,"").replace(/<\s*script[\s\S]*?<\s*\/\s*script\s*>/gm,"").replace(/^\s+|\s+$/gim," ").replace(/>\s([^<]*)\s</,function(e,t){return">"+t+"<"})}function he(e,t,n){(t||n)&&e.forEach(function(e){var r=e[0],i=e[1],a=e[2],o=r.children.indexOf(i),s=[o,1];a?n[a]&&s.push(n[a]):s=s.concat(t),r.children.splice.apply(r.children,s)})}function pe(e,t){t=t.replace(/\n/gim,"").trim();for(var n=!1,r="",i="",a={},o=[],s=0;s<t.length;s++){var c=t[s];if(n)"}"===c&&(n=!1,a.body=i.trim(),r="",o.push(a),a={}),i+=c;else{if("{"===c){n=!0,a.selector=r.trim(),i="";continue}r+=c}}var u="";return e="["+ft+'="'+e+'"]',o.forEach(function(t){for(var n=t.selector.split(","),r="",i=0;i<n.length;i++){var a=n[i].trim();r+=0===a.indexOf(":host")?","+a.replace(/:host/,e):","+e+" "+a}r=r.substr(1),u+=r+"{"+t.body+"}"}),u}function de(e){for(var t in e.computedState){var n=e.computedState[t],r=n.get||n;e.state[t]=n}var i=M(e),a=null;if(e.vnode){a=e.vnode.parent;var n=a.children,o=n.indexOf(e.vnode);o>-1&&n.splice(o,1,i)}e.vnode=i,i.parent=a,e.state=Ee.observe(e.state,e);for(var t in e.computedState){var n=e.computedState[t],r=n.get||n;if(Ge=t,Ke=e,r instanceof Function){var s=r.call(e);e.state[t]=s}}Ke=Ge=null,e.onCompile&&e.onCompile(e.vnode)}function ve(e,t){var n=oe(e.vnode,e);e.onBeforeMount&&e.onBeforeMount(n),e.el.parentNode.replaceChild(n,e.el),e.el=n;for(var r=e.children.length;r--;)le(e.children[r]);for(var r=0;r<e.children.length;r++)e.children[r].__url||ve(e.children[r],e.vnode);e.name&&(e.el.setAttribute(ft,e.name),e.vnode.setAttribute(ft,e.name)),e.onMount&&e.onMount(e.el),e.vnode.parent=t,ce(e.vnode,e,0)}function _e(e,t){var r=!0;if(e.onBeforeUpdate&&(r=e.onBeforeUpdate(t)),r!==!1){for(var i=M(e),a=T(i,e.vnode,e,a),o=0;o<e.children.length;o++){var s=e.children[o];s.compiledTmp||(le(s),s.__url||ve(s,e.vnode))}if(e.__watchFn){var c=e.__watchFn(e.state);for(var u in c){var l=c[u],f=e.__watchOldVal[u];(l!==f||n(l))&&e.__watchMap[u].call(e,l,f,u)}e.__watchOldVal=c}for(var h in e.__syncFn){var p=[e.state];a[h]&&(e.__syncFnForScope[h]=a[h]);var d=e.__syncFnForScope[h];if(d)for(var o=0;o<d.length;o++)p.push(d[o]);var v=e.__syncFn[h].apply(e,p);yt._cs[h].onPropChange&&yt._cs[h].onPropChange(v,e.__syncOldVal[h]),e.__syncOldVal[h]=v}e.onUpdate&&e.onUpdate(t),ce(e.vnode,e)}}function me(e,n,r){var i=new ie(n);return i.template=e,i.name="ROOT",r&&(t(r,i),o(r.state)&&(i.state=r.state.call(i))),i.onCreate&&i.onCreate(),i}function ge(e,n,r,a,s,c,u){"component"==n&&(n=u.is,u[".is"]&&(n=u[".is"],n=new Function("scope","with(scope){return "+n+"}")(a.state)));var l=mt[n];if(l){var f=new ie(r);return f.name=n,a.children.push(f),f.parent=a,f.root=a.root,f.store=f.root.store,f.vnode=e,u[at]&&(a.refs[u[at]]=f),u[ot]&&(yt.id[u[ot]]=f),e._directives.forEach(function(e){var t=e[1][0];if("on"===t){var n=e[1][1][0],r=e[2];r.match(/(?:^|this\.)([a-zA-Z_][a-zA-Z0-9_$]*)(?:\(|$)/);var i=RegExp.$1,o=a[i];o&&f.on(n,o.bind(a))}}),f.__attrs=u,f.__slots=s,f.__slotMap=c,i(l)?(f.__url=l,f):(l&&(t(l,f),o(l.state)?f.state=l.state.call(f):l.state&&(f.state={},t(l.state,f.state))),f.onCreate&&f.onCreate(),be(f,a,u),f)}}function be(e,t,n){var r={},i=e.input;if(i)for(var o in i){var s=i[o];s.require&&(r[o]=He),!a(s.value)&&a(e.state[o])&&(e.state[o]=s.value)}n&&ye(n,e,t,i,r)}function ye(e,r,i,o,s){var c="",u={};for(var l in e){var f=e[l];if(l!=at)if(l=l.replace(/-[a-z0-9]/g,function(e){return e[1].toUpperCase()}),l[0]===st){var h=l.substr(1);i[f]instanceof Function&&(f="this."+f),c+=","+JSON.stringify(h)+":"+f}else u[l]=f}c=c.substr(1);var p={};if(c){var d="",v="",_=r.vnode,m=[i.state],g=i.__syncFnForScope[r._uid]=[];if(_._forScopeQ)for(var b=0;b<_._forScopeQ.length;b++)d+="with(arguments["+(1+b)+"]){",v+="}",m.push(_._forScopeQ[b]),g.push(_._forScopeQ[b]);var y=i.__syncFn[r._uid]=new Function("scope","with(scope){"+d+"return {"+c+"}"+v+"}");p=i.__syncOldVal[r._uid]=y.apply(i,m)}var w=[];if(t(u,p),!a(u.store)){var x=null;x=u.store?u.store.split(" "):Object.keys(r.store.state),r.computedState||(r.computedState={}),x.forEach(function(e){var t=null;/[^\w]?(\w+)$/.test(e)&&(t=RegExp.$1,r.computedState[t]=new Function("with(this.store.state){ return "+t+"}"))})}for(var l in p){var f=p[l];n(f)&&f.__im__oid&&w.push(l),o&&l in o&&delete s[l]}if(r.onPropBind)r.onPropBind(p);else for(var l in p){var f=p[l];f instanceof Function?r[l]=f:r.state[l]=f}}function we(e,t,n){var r=(e.target||e.srcElement).value,i=t.getAttribute("number");a(i)||(r=parseFloat(r));var o=t.getAttribute("debounce");if(o){t.debounceTimer&&(clearTimeout(t.debounceTimer),t.debounceTimer=null);var s=this;t.debounceTimer=setTimeout(function(){clearTimeout(t.debounceTimer),t.debounceTimer=null,Se(t,r,s||n)},o)}else Se(t,r,this||n)}function xe(e,t,n){var i=e.target||e.srcElement,a=i.value,o="with(scope){return "+t.__exp+"}",s=new Function("scope",o),c=null;if(c=s(this?this.state:n.state),c=r(c)?c.concat():[c],i.checked)c.push(a);else{var u=c.indexOf(a);u>-1&&c.splice(u,1)}Se(t,c,n)}function Se(e,t,n){e.__store?n.store.commit("model",e.__exp,t):n.setState(e.__exp,t)}var Oe={},Ee=null;window.Proxy&&!function(){function e(e,t,n){isNaN(t)||(e[t>>0]=n)}function t(e,t){isNaN(t)||e.splice(t,1)}function i(e,t,a,o){if(a&&a.__im__propChain)return a;var s=r(a)?[]:{};for(var c in a){var u=a[c];if(n(u)){var l=t.concat();l.push(c);var f=i(e,l,u,o);s[c]=f}else s[c]=u}Object.defineProperty(s,"__im__propChain",{enumerable:!1,writable:!1,value:t});var h=new Proxy(s,e),p=Date.now()+Math.random();return Object.defineProperty(s,"__im__oid",{enumerable:!1,writable:!1,value:p}),h}Ee={observe:function(a,o){if(a&&a.__im__propChain)return a;var s={comp:o,get:function(e,t){if(Ge){var n=this.comp;if(n instanceof ie){var r=n.__dependence[t];r||(r=n.__dependence[t]=[]),r instanceof Array&&r.push(Ge)}else if(yt.Store){var i=n.__noticeMap[t];i||(i=n.__noticeMap[t]=[]),i.push([Ke,Ge])}}return e[t]},set:function(t,a,o){var s=!(a in t),c=t[a],u=o;if(c===u)return!0;var l=this.comp;if(l.computedState&&l.computedState[a]){var f=l.computedState[a].set;f instanceof Function&&f.call(l,u)}if(n(u)){var h=t.__im__propChain.concat();h.push(a),u=i(this,h,u,l)}r(t)?e(t,a,u):t[a]=u,l.__dependence&&l.__dependence[a]?l.__dependence[a].forEach(function(e){var t=l.computedState[e].call(l);l.state[e]=t}):yt.Store&&l.__noticeMap&&l.__noticeMap[a]&&l.__noticeMap[a].forEach(function(e){var t=e[0],n=e[1],r=t.computedState[n].get||t.computedState[n],i=r.call(t);t.state[n]=i});var p=t.__im__propChain,d={action:l.__action,object:t,name:a,pc:p,oldVal:c,newVal:u,comp:this.comp,type:s?"add":"update"};return Ie.handle(d),!0},deleteProperty:function(e,n){var i=e[n];r(e)?t(e,n):delete e[n];var a=e.__im__propChain,o={object:e,name:n,pc:a,oldVal:i,comp:this.comp,type:"delete"};return Ie.handle(o),!0}};return i(s,[],a,o)}}}(),!window.Proxy&&!function(){function e(e){return this.__im__innerProps[e]}function t(e,t){var r=this.__im__innerProps[e];if(r&&o(r),n(t)){var a=this.__im__propChain.concat();a.push(e),t=i(a,t,this.__im__comp)}this.__im__innerProps[e]=t;this.__im__propChain;s([{name:e,target:this,oldVal:r,newVal:t,type:"update"}],!0)}function i(a,o,s){if(o&&o.__im__propChain)return o;var u=r(o)?[]:{};Object.defineProperty(u,"__im__innerProps",{enumerable:!1,writable:!0,value:{}});var l={},f={};for(var h in o)if(o.hasOwnProperty(h)){var p=o[h];if(n(p)){var d=a.concat();d.push(h);var v=i(d,p,s);u.__im__innerProps[h]=v}else u.__im__innerProps[h]=p;f[h]=p,!function(n){l[n]={get:function(){return e.call(this,n)},set:function(e){t.call(this,n,e)},enumerable:!0,configurable:!0}}(h)}Object.defineProperties(u,l),Object.defineProperty(u,"__im__propChain",{enumerable:!1,writable:!1,value:a}),Object.defineProperty(u,"__im__comp",{enumerable:!1,writable:!1,value:s});var _=Date.now()+Math.random();return Object.defineProperty(u,"__im__oid",{enumerable:!1,writable:!1,value:_}),c.push({snap:f,now:u,id:_}),u}function a(){u(function(){for(var e=c.length;e--;){var t=c[e],n=t.snap,r=t.now,i=(t.id,[]);for(var o in n)if(!(o in r)){var u={};u.name=o,u.target=r,u.oldVal=n[o],u.snap=n,u.type="delete",i.push(u)}for(var o in r)if(!(o in n)){var u={};u.name=o,u.target=r,u.newVal=r[o],u.snap=n,u.type="add",i.push(u)}i.length>0&&s(i)}a()})}function o(e){for(var t=null,r=c.length;r--&&(t=c[r],t.id!==e.__im__oid););r>-1&&(c.splice(r,1),n(t)&&o(t))}function s(r,a){for(var s=r.length;s--;){var c=r[s],u=c.name,l=c.target,f=l.__im__propChain,h=l.__im__comp,p=c.oldVal,d=c.newVal,v=c.type,_=c.snap;if("add"===v){if(_[u]=d,l.__im__innerProps[u]=d,n(d)){var m=f.concat();m.push(u),l.__im__innerProps[u]=i(m,d,h)}!function(n,r){Object.defineProperty(r,n,{get:function(){return e.call(this,n)},set:function(e){t.call(this,n,e)},enumerable:!0,configurable:!0})}(u,l)}else if("delete"===v){var g=_[u];n(g)&&o(g),delete _[u]}else if(!a){console.log("无效update");continue}var b={object:l,name:u,pc:f,oldVal:p,newVal:d,comp:h,type:v};Ie.handle(b)}}var c=[],u=function(e){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||function(t){return e.setTimeout(function(){t(Date.now())},16.7)}}(self);Ee={},Ee.observe=function(e,t){return e&&e.__im__propChain?e:i([],e,t)},a()}();var Ne=0;f.prototype={on:function(e,t){var n=gt[e];n||(n=gt[e]={});var r=!1;if(o(t)&&(r=!0),r)n[this.vid]=[this,t,this._cid,r];else{var i=this.getAttribute("var");if(i){var a=i.replace(/^{|}$/gm,"").split(","),s="";a.forEach(function(e){var t=e.split(":");s+="var "+t[0]+"="+t[1]+";"}),i=s}var c="",u="";if(this._forScopeQ)for(var l=0;l<this._forScopeQ.length;l++)c+="with(arguments["+(4+l)+"]){",u+="}";n[this.vid]=[this,new Function("comp,state,$event,$vnode","with(comp){with(state){"+c+i+";"+t+u+"}}"),this._cid]}this._hasEvent=!0},off:function(e){var t=gt[e];if(t)t[this.vid]=null;else if(!e)for(var n in gt)t=gt[n],t&&(t[this.vid]=null)},setAttribute:function(e,t){return this.attrNodes[e]=t,this},getAttribute:function(e){return this.attrNodes[e]}};var Ce=[],Fe=["br","hr","img","input","link","meta","area","base","col","embed","keygen","param","source","track","wbr"],Ae=/<([-a-z0-9]+)((?:\s+[-a-zA-Z0-9_:.]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')))?)*)\s*(?:\/?)>/im,ke=/[a-zA-Z_:.][-a-zA-Z0-9_:.]*(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?/gim,Me=/<\/([-a-z0-9]+)>/im,Te=/<\/([-a-z0-9]+)>/gim,Pe=0,je=null,Be=self.navigator.userAgent.toLowerCase(),Le=Be.indexOf("android")>0?!0:!1,Ve=Be.indexOf("iphone")>0?!0:!1,Qe=Be.indexOf("ipad")>0?!0:!1,De=Be.indexOf("windows phone")>0?!0:!1,$e=Ve||Qe||Le||De;if($e){var Re,qe,ze=200,Je=0,Ue=!1,Ze=!1;document.addEventListener("touchstart",U,!0),document.addEventListener("touchmove",Z,!0),document.addEventListener("touchend",Y,!0),document.addEventListener("touchcancel",H,!0)}else{document.addEventListener("mousedown",X,!0),document.addEventListener("mousemove",I,!0),document.addEventListener("mouseup",G,!0),window.addEventListener("blur",K,!0);var He=null==self.onmousewheel?"mousewheel":"DOMMouseScroll";document.addEventListener(He,te,!0),document.addEventListener("mouseout",W,!0),document.addEventListener("mouseover",ee,!0);var Re,Ye=0}document.addEventListener("input",function(e){z("input",e)},!0),document.addEventListener("change",function(e){z("change",e)},!0),document.addEventListener("keydown",function(e){z("keydown",e)},!0),document.addEventListener("keypress",function(e){z("keypress",e)},!0),document.addEventListener("keyup",function(e){z("keyup",e)},!0),document.addEventListener("focus",function(e){z("focus",e)},!0),document.addEventListener("blur",function(e){z("blur",e)},!0);var Xe=null==self.onwheel?"wheel":"mousewheel";document.addEventListener(Xe,function(e){z("wheel",e)},!0),document.addEventListener("scroll",function(e){z("scroll",e)},!0);var Ie=new function(){function e(e){for(var t=i.length;t--;){var n=i[t];if(n.object.__im__oid===e.object.__im__oid&&n.name===e.name)break}t>-1?i.splice(t,1,e):i.push(e)}function t(e,t,n,i,o,s,c,u){var l=[];if(l=c.concat(),r(s)||l.push(o),n){a[n._uid]||(a[n._uid]={change:{},comp:n});var f=new ne(o,e,t,l,i,s);a[n._uid].change[o]=u?[f,u]:f}}var n=!1,i=[],a={};this.handle=function(r){n?e(r):(i=[],a={},n=!0,i.push(r),setTimeout(function(){n=!1,i.forEach(function(e){var n=e.comp,r=e.newVal,i=e.oldVal,a=e.pc,o=e.type,s=e.name,c=e.object;t(r,i,n,o,s,c,a,e.action)});var e=a;for(var r in e)e[r].comp instanceof ie?_e(e[r].comp,e[r].change):e[r].comp.__update(e[r].change)},20))}};re.prototype={on:function(e,t,n){return this.__eeMap[e]=[t,n||this],this},emit:function(e){var t=this.__eeMap[e];if(t){var n=t[0],r=t[1];if(n){for(var i=[],a=1;a<arguments.length;a++)i.push(arguments[a]);return n.apply(r,i)}}}},ae.prototype=re.prototype,ie.prototype=new ae,ie.prototype.constructor=ie.constructor,t({setState:function(e,t){t=JSON.stringify(t);var n="with(scope){"+e+"="+t+"}",r=new Function("scope",n);return r(this.state),this},watch:function(e,t){this.__watchPaths.push(e);for(var n="",r=this.__watchPaths.length;r--;){var i=this.__watchPaths[r];n+=","+JSON.stringify(i)+":"+i}n=n.substr(1);var a=this.__watchFn=new Function("scope","with(scope){return {"+n+"}}");return this.__watchOldVal=a(this.state),this.__watchMap[e]=t,this},destroy:function(){if(this.onDestroy&&this.onDestroy(),this.parent){this.parent.__syncFn[this._uid]=null,this.parent.__syncOldVal[this._uid]=null,this.parent.__syncFnForScope[this._uid]=null,delete this.parent.__syncFn[this._uid],delete this.parent.__syncOldVal[this._uid],delete this.parent.__syncFnForScope[this._uid];var e=this.parent.children.indexOf(this);e>-1&&this.parent.children.splice(e,1),this.parent=null}for(;this.children.length>0;)this.children[0].destroy();this.children=yt._cs[this._uid]=null,delete yt._cs[this._uid],this.refs=this.__nodes=this.__syncFn=this._uid=this.__url=this.template=this.state=null},onPropChange:function(e,t){for(var n in e){var r=e[n];r!==this.state[n]&&(this.state[n]=r)}}},ie.prototype);var Ge,Ke,We="x-",et=":",tt=".",nt="{{",rt="}}",it=/^x-.*/,at="ref",ot="id",st=".",ct=":",ut=".",lt=new RegExp(nt+"(.+?)(?:(?:(?:=>)|(?:=&gt;))(.+?))?"+rt,"img"),ft="impex-component",ht="slot",pt=0,dt={},vt={},_t={},mt={component:1},gt={},bt={},yt=new function(){this.id={},this.version={v:[0,98,0],state:"alpha",toString:function(){return yt.version.v.join(".")+" "+yt.version.state}},this.website="http://impexjs.org",this.config=function(e){var t=e.delimiters||[];nt=t[0]||"{{",rt=t[1]||"}}",lt=new RegExp(nt+"(.+?)(?:(?:(?:=>)|(?:=&gt;))(.+?))?"+rt,"img")},this.component=function(e,t){return mt[e]=t,this},this.hasComponentOf=function(e){return!!mt[e]},this.directive=function(e,t){return vt[e]=t,this},this.filter=function(e,t){return dt[e]=t,this},this.renderTo=function(e,t,n){for(var r=document.querySelectorAll('link[rel="impex"]'),a=r.length;a--;){var o=r[a],s=o.getAttribute("type"),c=o.getAttribute("href");yt.component(s,c)}i(t)&&(t=document.querySelector(t));var u=me(e,t,n);return u.root=u,le(u),ve(u),u},this.render=function(e,t){i(e)&&(e=document.querySelector(e));var n=e.outerHTML;return this.renderTo(n,e,t)},Object.defineProperty(this,"_cs",{enumerable:!1,writable:!0,value:{}}),this.Component=ie,this.EventEmitter=re,this._Observer=Ee};yt.directive("style",{onBind:function(e,t){var n=t.value;if(i(n)){for(var r={},a=n.split(";"),o=a.length;o--;)if(a[o]){var s=a[o].split(":");r[s[0]]=s[1]}n=r}var c=e.getAttribute("style")||"";for(var u in n){var l=this.filterName(u),f=n[u];l=l.replace(/[A-Z]/gm,function(e){return"-"+e.toLowerCase()}),c+=l+":"+f+";"}e.setAttribute("style",c)},filterName:function(e){return e.replace(/-([a-z])/gim,function(e,t){return t.toUpperCase()})}}).directive("class",{onBind:function(e,t){var n=t.value,a=e.getAttribute("class")||"";if(i(n))a+=" "+n;else if(r(n))a+=" "+n.join(" ");else for(var o in n){var s=n[o];s&&(a+=" "+o)}e.setAttribute("class",a)}}).directive("on",{onBind:function(e,t){for(var n=t.args,r=n.length;r--;)e.on(n[r],t.value)}}).directive("bind",{onBind:function(e,t){for(var n=t.args,r=n.length;r--;){var i=n[r];switch(i){case"style":vt[i].onBind(e,t);break;case"class":vt[i].onBind(e,t);break;default:e.setAttribute(i,t.value)}}}}).directive("show",{onBind:function(e,t){var n=t.value,r=e.getAttribute("style")||"";n?r=r.replace(/display\s*:\s*none\s*;?/,""):r+=";display:none;",e.setAttribute("style",r)}}).directive("cloak",{}).directive("model",{onBind:function(e,t){switch(e.__exp=t.exp,e.__store=t.args&&"store"==t.args[0]?!0:!1,e.tag){case"select":e.on("change",this.handleChange);break;case"input":var n=e.attrNodes.type;if("radio"==n||"checkbox"==n){e.on("change",this.handleChange);break}default:e.on("input",we)}},handleChange:function(e,t){{var n=e.target,r=n.tagName.toLowerCase();n.value}switch(r){case"textarea":case"input":var i=n.getAttribute("type");switch(i){case"radio":we(e,t,this);break;case"checkbox":xe(e,t,this)}break;case"select":var a=n.getAttribute("multiple");if(null!==a){for(var o=[],s=n.options.length;s--;){var c=n.options[s];c.selected&&o.push(c.value)}Se(t,o,this)}else we(e,t,this)}}}),yt.filter("json",function(e){return JSON.stringify(e)}).filter("filterBy",function(e,t,n){
var i=e;if(!r(i))return e;var a=[];if(o(t))for(var s=i.length;s--;){var c=t.call(this,i[s]);c&&a.unshift(i[s])}else for(var s=i.length;s--;){var u=i[s];n?(!t||(u[n]+"").indexOf(t)>-1)&&a.unshift(u):(!t||u.indexOf&&u.indexOf(t)>-1)&&a.unshift(u)}return a}).filter("limitBy",function(e,t,n){return r(e)&&t?e.splice(n||0,t):e}).filter("orderBy",function(e,t,n){return(t||n)&&r(e)?(e.sort(function(e,n){var r=t?e[t]:e,i=t?n[t]:n;return"string"==typeof r?r.localeCompare(i):"number"==typeof r?r-i:(r+"").localeCompare(i)}),"desc"===n&&e.reverse(),e):e}),"object"==typeof module&&"object"==typeof module.exports?module.exports=yt:e.impex=yt}(window||this);